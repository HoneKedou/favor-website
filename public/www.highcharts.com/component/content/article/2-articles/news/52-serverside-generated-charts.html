
<!DOCTYPE html>
<!--[if IE 8 ]><html class="ie8" lang="en-gb"> <![endif]-->
<!--[if IE 9 ]><html class="ie9" lang="en-gb"><![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en-gb"><!--<![endif]-->
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<head>
  <!--<base href="http://www.highcharts.com/component/content/article/2-articles/news/52-serverside-generated-charts" />-->
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="keywords" content="highcharts, charts, javascript charts, ajax charts, plots, line charts, bar charts, pie charts, javascript plots, ajax plots" />
  <meta name="author" content="Super User" />
  <meta name="og:title" content="Render charts on the server" />
  <meta name="og:type" content="article" />
  <meta name="og:url" content="http://www.highcharts.com/component/content/article/2-articles/news/52-serverside-generated-charts" />
  <meta name="og:site_name" content="Highcharts" />
  <meta name="description" content="Highcharts - Interactive JavaScript charts for your web pages." />
  <meta name="generator" content="Joomla! - Open Source Content Management" />
  <title>Highcharts - Render charts on the server</title>
  <link rel="stylesheet" href="/media/system/css/modal.css" type="text/css" />
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,700,400italic" type="text/css" />
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../joomla/templates/highsoft_colorful/css/template.css" type="text/css" />
  <script src="/media/system/js/mootools-core.js" type="text/javascript"></script>
  <script src="/media/system/js/core.js" type="text/javascript"></script>
  <script src="/media/system/js/caption.js" type="text/javascript"></script>
  <script src="/media/system/js/modal.js" type="text/javascript"></script>
  <script src="../../../../../lib/jquery-1.7.2.js" type="text/javascript"></script>
  <script src="/templates/highsoft_colorful/js/jquery.cookies.2.2.0.js" type="text/javascript"></script>
  <script src="/templates/highsoft_colorful/js/slide.js" type="text/javascript"></script>
  <script type="text/javascript">
window.addEvent('load', function() {
				new JCaption('img.caption');
			});
		window.addEvent('domready', function() {

			SqueezeBox.initialize({});
			SqueezeBox.assign($$('a.modal'), {
				parse: 'rel'
			});
		});
  </script>

<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1"><link href="/templates/highsoft_colorful/images/favicon.ico" rel="shortcut icon"/><!-- Echo Header Script -->

</head>
<body id="bd" class="clearfix">
	<div id="zt-wrapper">
		<div id="zt-wrapper-inner">
						<!--Header-->
			<div id="zt-header" class="clearfix">
				<div class="container">
			        					<div id="zt-header-inner" class="row-fluid">
			            <!-- Logo -->
													<a  id="zt-logo-image"  class="span3" href="../../../../../index.html" title="Highcharts"><img src="/templates/highsoft_colorful/images/logo.svg" alt="Highcharts" /></a>
									            <!-- #Logo -->
			            <!--Mainmenu-->
			            <div id="zt-mainmenu" class="span9 pull-right" >
			                <div id="zt-mainmenu-inner" class="row-fluid">
			                    <div class="smallmenu"><div class="menusys_mega"><ul><li class="first "><a href="../../../../../about.html"  ><span>About Us</span></a></li><li class="hasChild"><a><span>Our Products</span></a><ul class="submenu"><li class="first"><a href="../../../../../products/highcharts.html"  ><span>Highcharts</span></a></li><li><a href="../../../../../products/highstock.html"  ><span>Highstock</span></a></li><li><a href="../../../../../products/highmaps.html"  ><span>Highmaps</span></a></li><li class="last"><a href="http://highslide.com/"  ><span>Highslide JS</span></a></li></ul></li><li class="last "><a href="../../../../../contact-email.html"  ><span>Contact</span></a></li></ul></div></div><div class="largemenu"><div class="menusys_mega"><ul><li class="first "><a href="../../../../../index.html"  ><span>Home</span></a></li><li class="hasChild"><a><span>Demo</span></a><ul class="submenu"><li class="first"><a href="../../../../../demo.html"  ><span>Highcharts demos</span></a></li><li><a href="../../../../../stock/demo.html"  ><span>Highstock demos</span></a></li><li class="last"><a href="../../../../../maps/demo.html"  ><span>Highmaps demo</span></a></li></ul></li><li class="hasChild"><a><span>Docs</span></a><ul class="submenu"><li class="first"><a href="../../../../../docs.html"  ><span>General Documentation</span></a></li><li><a href="http://api.highcharts.com/highcharts"  ><span>Highcharts API Reference</span></a></li><li><a href="http://api.highcharts.com/highstock"  ><span>Highstock API Reference</span></a></li><li><a href="http://api.highcharts.com/highmaps"  ><span>Highmaps API Reference</span></a></li><li><a href="../../../../../documentation/compatibility.html"  ><span>Compatibility</span></a></li><li class="last"><a href="../../../../../documentation/changelog.html"  ><span>Changelog</span></a></li></ul></li><li class="hasChild"><a><span>Support</span></a><ul class="submenu"><li class="first"><a href="../../../../../support.html"  ><span>Support</span></a></li><li><a href="../../../../../support/roadmap.html"  ><span>Roadmap</span></a></li><li><a href="../../../../../download.html"  ><span>Download</span></a></li><li class="last"><a href="http://forum.highcharts.com/"  ><span>Forum</span></a></li></ul></li><li><a href="../../../../../plugin-registry.html"  ><span>Plugins</span></a></li><li class="last "><a href="http://shop.highsoft.com/"  ><span>Shop</span></a></li></ul></div></div>			                </div>
			            </div>
			            <!--#Mainmenu-->
						<!--Drill Menu-->
						<div class="zt-drillmenu-inner">
							<div class="navbar">
								<a class="btn-navbar collapsed" id="mobile-button" data-toggle="collapse" data-target=".menusys_drill"></a>
								<div class="menusys_drill collapse"><ul id="zo2-drilldown-menu" class="nav-drilldown"><li class="first item"><a href="../../../../../index.html"  id="menusys101_drill" title="Home"><span class="menusys_name">Home</span></a></li><li class="item hasChild"><a id="menusys103_drill" title="Demo"><span class="menusys_name">Demo</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../../../../demo.html"  id="menusys106_drill" title="Highcharts demos"><span class="menusys_name">Highcharts demos</span></a></li><li class="item"><a href="../../../../../stock/demo.html"  id="menusys107_drill" title="Highstock demos"><span class="menusys_name">Highstock demos</span></a></li><li class="last item"><a href="../../../../../maps/demo.html"  id="menusys205_drill" title="Highmaps demo"><span class="menusys_name">Highmaps demo</span></a></li></ul></li><li class="item hasChild"><a id="menusys108_drill" title="Docs"><span class="menusys_name">Docs</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../../../../docs.html"  id="menusys128_drill" title="General Documentation"><span class="menusys_name">General Documentation</span></a></li><li class="item"><a href="http://api.highcharts.com/highcharts"  id="menusys124_drill" title="Highcharts API Reference"><span class="menusys_name">Highcharts API Reference</span></a></li><li class="item"><a href="http://api.highcharts.com/highstock"  id="menusys125_drill" title="Highstock API Reference"><span class="menusys_name">Highstock API Reference</span></a></li><li class="item"><a href="http://api.highcharts.com/highmaps"  id="menusys211_drill" title="Highmaps API Reference"><span class="menusys_name">Highmaps API Reference</span></a></li><li class="item"><a href="../../../../../documentation/compatibility.html"  id="menusys126_drill" title="Compatibility"><span class="menusys_name">Compatibility</span></a></li><li class="last item"><a href="../../../../../documentation/changelog.html"  id="menusys127_drill" title="Changelog"><span class="menusys_name">Changelog</span></a></li></ul></li><li class="item hasChild"><a id="menusys109_drill" title="Support"><span class="menusys_name">Support</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../../../../support.html"  id="menusys110_drill" title="Support"><span class="menusys_name">Support</span></a></li><li class="item"><a href="../../../../../support/roadmap.html"  id="menusys129_drill" title="Roadmap"><span class="menusys_name">Roadmap</span></a></li><li class="item"><a href="../../../../../download.html"  id="menusys201_drill" title="Download"><span class="menusys_name">Download</span></a></li><li class="last item"><a href="http://forum.highcharts.com/"  id="menusys208_drill" title="Forum"><span class="menusys_name">Forum</span></a></li></ul></li><li class="item"><a href="../../../../../plugin-registry.html"  id="menusys111_drill" title="Plugins"><span class="menusys_name">Plugins</span></a></li><li class="item"><a href="http://shop.highsoft.com/"  id="menusys115_drill" title="Shop"><span class="menusys_name">Shop</span></a></li><li class="item"><a href="../../../../../about.html"  id="menusys112_drill" title="About Us"><span class="menusys_name">About Us</span></a></li><li class="item hasChild"><a id="menusys113_drill" title="Our Products"><span class="menusys_name">Our Products</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../../../../products/highcharts.html"  id="menusys121_drill" title="Highcharts"><span class="menusys_name">Highcharts</span></a></li><li class="item"><a href="../../../../../products/highstock.html"  id="menusys122_drill" title="Highstock"><span class="menusys_name">Highstock</span></a></li><li class="item"><a href="../../../../../products/highmaps.html"  id="menusys210_drill" title="Highmaps"><span class="menusys_name">Highmaps</span></a></li><li class="last item"><a href="http://highslide.com/"  id="menusys123_drill" title="Highslide JS"><span class="menusys_name">Highslide JS</span></a></li></ul></li><li class="last item"><a href="../../../../../contact-email.html"  id="menusys114_drill" title="Contact"><span class="menusys_name">Contact</span></a></li></ul></div>							</div>
							<div class="clearfix"></div>
						</div>
						<!--#Drill Menu-->
					</div>
				</div>
			</div>
			<!--#Header-->
            <!--Slideshow-->
                        <!--#Slideshow-->
            			            <!-- ZT Userwrap2 -->
			            <!-- #ZT Userwrap2 -->
            <!-- ZT Userwrap3 -->
			            <!-- #ZT Userwrap3 -->
                        			<!--Main-->
						<div id="zt-mainframe" class="clearfix">
				<div class="container">
					<div id="zt-mainframe-inner" class="row-fluid clearfix">
						<div id="zt-mainframe-inner2" class="zt-container">
														<div id="zt-content" class="span12">
																<div id="zt-component" class="clearfix">
									<div id="zt-component-inner">
										
<div id="system-message-container">
</div>
										
<article class="item-page">
	
	<header class="clearfix">
		
				<h1>
							Render charts on the server					</h1>
		
			</header>

	






<p><strong>We're proud to present our new feature, true server side generation of charts without the use of a web client. It's the perfect solution for email and report generation.</strong></p>
<p>The export module has always been an important feature for Highcharts. With this module your users can download an image copy of a chart. This image is generated by the browser post an SVG file to the export server where it generates a image in the desired format and returns it for download. However, until now, a browser was required in order to generate the SVG and send the post.</p>
<h3>Downloads related to this article</h3>
<ul>
<li><a href="https://github.com/highslide-software/highcharts.com/tree/master/exporting-server/phantomjs">The Phantom JS script</a></li>
<li><a href="https://github.com/highslide-software/highcharts.com/tree/master/exporting-server/java">The Java export server</a></li>
</ul>
<h3>Running Highcharts on the server side</h3>
<p>We have released a script which makes it possible to run Highcharts on the server. Why?</p>
<ol>
<li>you want to include your charts in emails or automated management reports</li>
<li>you want to have a consistency between graphs you present on your website and your backend produced reports</li>
</ol>
<div style="position: relative; float: right;"><img src="http://www.highcharts.com/images/stories/articles/phantomjs-logo.png" border="0" alt="" /></div>
<p>For running Highcharts on the server, we need to emulate a browser environment on the server. For this we use <a href="http://phantomjs.org/">PhantomJS</a>, a headless WebKit with JavaScript API. The Phantom process takes our <em>highcharts-convert.js</em> script as an argument plus command line parameters. With the command line parameters we pass over the Highcharts configuration, the name of the output file and parameters for the graphical layout. Example usage:</p>
<pre>phantomjs highcharts-convert.js -infile options.json -outfile chart.png -scale 2.5 -width 300 -constr Chart -callback callback.js</pre>
<p>For a detailed explaination of the paramters, see <a href="52-serverside-generated-charts.html#phantom_usage">Example usage of PhantomJS</a>.</p>
<h3>Also featured on the export server</h3>
<p>We included the above PhantomJS script also on the Java-based export server and with this you can POST a Highcharts configuration to the export server and return an image of the chart. The chart is created and rendered on the server.</p>
<p>An online demo with a GUI can be viewed at <a href="http://export.highcharts.com/demo">export.highcharts.com/demo</a>. For an overview of possible POST parameters, <a href="52-serverside-generated-charts.html#post-param"> see here</a></p>
<div style="position: relative; float: right;"> </div>
<p>See for a schematic overview of the arcitecture the image here below.</p>
<p><img src="http://www.highcharts.com/images/stories/articles/drawing-export-server.svg" border="0" /></p>
<h3>Defining the right combination of tools</h3>
<p>We came across a lot of tools when searching for the optimal solution for running Highcharts server side. Here is an overview of our findings:</p>
<dl><dt>Batik and Rhino + env.js or jsdom</dt><dd>env.js or jsdom have no good concept of the box-model. We ran into problems when placing labels because we couldn't get SVG's getBBox method to work reliably.</dd><dt>PhantomJS in PHP</dt><dd>Call PhantomJS with the highcharts-convert.js script from PHP and let PhantomJS convert JSON or SVG files to different image formats. Although local benchmarks show a great performance of rasterizing with PhantomJS, in production we ran into trouble when converting SVG files with more than 1500 data points. It simply took too long time in our server environment, perhaps due to creating files locally and the number of concurrent users?</dd><dt>Imagemagick, PhantomJS in PHP</dt><dd>The idea was to let PhantomJS generate the SVG file and let ImageMagick do the image conversion. In production we couldn't get Imagemagick (version 6.8) to run stable on the server. Approximately once a day CPU went up to 100% and we had to restart the export server. We followed up several hints found on forums, like compiling natively and setting specific settings, but in the end we gave up. Another disadvantage was that semi-transparent shapes where rasterized in PDF export. This is better handled in Batik.</dd></dl>
<p>This search resulted in using Batik natively in a Java web application which calls Phantom via a system command. We're quite satisfied with the result of the produced images, repsonse time and stability. Probably a combination of PhantomJS and Batik in PHP would also be good choice, but we preferred to run Batik natively and avoid creation of temporary files. If you would like to setup your own Highcharts export-server, see <a href="https://github.com/highslide-software/highcharts.com/blob/master/exporting-server/java/readme.md">here</a> for a installation description.</p>
<p><strong>After a period of time we came to the conclusion that we don't need BATIK any longer. All request are now forwarded to PhantomJS</strong></p>
<p><span style="color: #135cae; font-family: Helvetica, Arial, sans-serif; font-size: 13px; font-weight: bold; line-height: 1.3em;">Example usage of PhantomJS and highcharts-convert.js</span></p>
<pre>phantomjs highcharts-convert.js -infile options1.json -outfile chart1.png -scale 2.5 -width 300 -constr Chart -callback callback.js</pre>
<p>Description of command line parameters</p>
<table class="datatable">
<tbody>
<tr>
<td style="width: 100px;">-infile</td>
<td>The file to convert, the script have to find if this is a javascript file with a options object or a svg file.  It checks the input file for beginning with "&lt;svg", "&lt;?xml" or "&lt;!doctype". Then it's a svg file, otherwise it's presumed to be an options file.</td>
</tr>
<tr>
<td>-outfile</td>
<td>The file to output. Must be a filename with the extension .jpg, .png .pdf or .svg. </td>
</tr>
<tr>
<td>-type</td>
<td>The type can be of jpg, png, pfd or svg. Ignored when outfile is defined. This is used when specifying the outfile has no usage. For example in servermode, when the output isn't a file but a 64bit string. When not running in servermode the file is stored in 'tmpdir'</td>
</tr>
<tr>
<td>-scale</td>
<td>To set the zoomFactor of the page rendered by PhantomJs. For example, if the chart.width option in the chart configuration is set to 600 and the scale is set to 2, the output raster image will have a pixel width of 1200. So this is a convenient way of increasing the resolution without decreasing the font size and line widths in the chart. This is ignored if the -width parameter is set.</td>
</tr>
<tr>
<td>-width</td>
<td>Set the exact pixel width of the exported image or pdf. This overrides the -scale parameter.</td>
</tr>
<tr>
<td>-constr</td>
<td>The constructor name. Can be one of Chart or StockChart. This depends on whether you want to generate Highstock or basic Highcharts.</td>
</tr>
<tr>
<td>-callback</td>
<td>Filename containing a callback JavaScript. The callback is a function which will be called in the constructor of Highcharts to be executed on chart load. All code of the callback must be enclosed by a function. Example of contents of the callback file:
<pre>function(chart) {
    chart.renderer.arc(200, 150, 100, 50, -Math.PI, 0).attr({
        fill : '#FCFFC5',
        stroke : 'black',
        'stroke-width' : 1
     }).add();
}</pre>
</td>
</tr>
<tr>
<td>-host</td>
<td>Specify the host for running the script as an lightweight http-server. The server responds to JSON objects send to the server in a POST  </td>
</tr>
<tr>
<td>-port</td>
<td>Specify the port which the http-server listens on.</td>
</tr>
<tr>
<td>-tmpdir</td>
<td>Specify where the scipt stores temporary- or output files, when output isn't defined.</td>
</tr>
</tbody>
</table>
<p> </p>
<h3 id="post-param">Description of POST parameters for the Highcharts export server</h3>
<table class="datatable">
<tbody>
<tr>
<td style="width: 100px;">svg</td>
<td>The string representation of a SVG file you want to export. Can be overridden by the <strong>options</strong> parameter.</td>
</tr>
<tr>
<td>options</td>
<td>Use this parameter if you want to create a graph out of a Highcharts configuration. The options are sent as a JSON string. This parameter overrides the <strong>svg</strong> option.</td>
</tr>
<tr>
<td>type</td>
<td>The content-type of the file to output. Can be one of 'image/png', 'image/jpeg', 'application/pdf', or 'image/svg+xml'.</td>
</tr>
<tr>
<td>filename</td>
<td>The name of the exported file. Defaults to 'Chart'.</td>
</tr>
<tr>
<td>scale</td>
<td>To scale the original SVG. For example, if the chart.width option in the chart configuration is set to 600 and the scale is set to 2, the output raster image will have a pixel width of 1200. So this is a convenient way of increasing the resolution without decreasing the font size and line widths in the chart. This is ignored if the -width parameter is set. For now we allow a maximum scaling of <strong>4</strong>. This is for ensuring a good repsonse time. Scaling is a bit resource intensive.</td>
</tr>
<tr>
<td>width</td>
<td>Set the exact pixel width of the exported image or pdf. This overrides the -scale parameter. The maximum allowed width is 2000px</td>
</tr>
<tr>
<td>constr</td>
<td>The constructor name. Can be one of 'Chart' or 'StockChart'. This depends on whether you want to generate Highstock or basic Highcharts. Only applicable when using this in combination with the <strong>options</strong> parameter.</td>
</tr>
<tr>
<td>callback</td>
<td>String containing a callback JavaScript. The callback is a function which will be called in the constructor of Highcharts to be executed on chart load. All code of the callback must be enclosed by a function. Only applicable when using this in combination with the <strong>options</strong>parameter. Example of contents of the callback file:
<pre>function(chart) {
    chart.renderer.arc(200, 150, 100, 50, -Math.PI, 0).attr({
        fill : '#FCFFC5',
        stroke : 'black',
        'stroke-width' : 1
     }).add();
}</pre>
</td>
</tr>
<tr>
<td>async</td>
<td><span style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px;">Can be of true or false. Default is false. When setting async to true a download link is returned to the client, instead of an image. This download link can be reused for 30 seconds. After that, the file will be deleted from the server. </span>See these example to get an idea of what you can do with async downloading. <a href="http://jsfiddle.net/highcharts/DXQSU/" style="line-height: 18px;">http://jsfiddle.net/highcharts/DXQSU/</a><span class="s1" style="line-height: 18px;"> and <a href="http://jsfiddle.net/highcharts/fFPNP/"><span class="s2">http://jsfiddle.net/highcharts/fFPNP/</span> </a> </span></td>
</tr>
</tbody>
</table> 



		
</article>
									</div>
								</div>
																							</div>
							
														<div class="clearfix"></div>
						</div>
					</div>
				</div>
			</div>
			<!--#main-->
			            <!-- ZT Userwrap6 -->
			            <!-- #ZT Userwrap6 -->
            <!-- ZT Userwrap7 -->
			            <!-- #ZT Userwrap7 -->
			<!--Footer-->
			<div id="zt-footer" class="clearfix ">
				<div class="container">
					<div id="zt-footer-inner" class="row-fluid">
						<div id="zt-footer-left" class="span6">
															
							<div id="zt-footer-copy">
							© 2014 Highcharts. All rights reserved.							</div>
						</div>
												<div id="zt-social" class="span4">
							<div>
<a href="https://www.facebook.com/Highcharts" title="Facebook" class="social-icon"><i class="fa fa-facebook"></i></a>
<a href="https://twitter.com/Highcharts" title="Twitter" class="social-icon"><i class="fa fa-twitter"></i></a>
<a href="http://www.linkedin.com/company/highsoft-solutions-as" title="LinkedIn" class="social-icon"><i class="fa fa-linkedin"></i></a>
<a href="https://github.com/highslide-software/highcharts.com" title="Github" class="social-icon"><i class="fa fa-github"></i></a>
</div>
						</div>
												<div class="clearfix"></div>
					</div>
				</div>
			</div>
            <!--#Footer-->
		</div>
	</div>
	
	    <!-- Echo Footer Script -->
        	<script type="text/javascript">
		var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
		document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
	</script>
	<script type="text/javascript">
		try {
			var pageTracker = _gat._getTracker("UA-2995052-3");
			pageTracker._trackPageview();
		} catch(err) {}
	</script>
</body>
</html>
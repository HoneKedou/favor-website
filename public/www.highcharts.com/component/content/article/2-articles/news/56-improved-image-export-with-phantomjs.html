
<!DOCTYPE html>
<!--[if IE 8 ]><html class="ie8" lang="en-gb"> <![endif]-->
<!--[if IE 9 ]><html class="ie9" lang="en-gb"><![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en-gb"><!--<![endif]-->
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<head>
  <!--<base href="http://www.highcharts.com/component/content/article/2-articles/news/56-improved-image-export-with-phantomjs" />-->
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="keywords" content="highcharts, charts, javascript charts, ajax charts, plots, line charts, bar charts, pie charts, javascript plots, ajax plots" />
  <meta name="author" content="Super User" />
  <meta name="og:title" content="Improved image export with PhantomJS" />
  <meta name="og:type" content="article" />
  <meta name="og:url" content="http://www.highcharts.com/component/content/article/2-articles/news/56-improved-image-export-with-phantomjs" />
  <meta name="og:site_name" content="Highcharts" />
  <meta name="description" content="Highcharts - Interactive JavaScript charts for your web pages." />
  <meta name="generator" content="Joomla! - Open Source Content Management" />
  <title>Highcharts - Improved image export with PhantomJS</title>
  <link rel="stylesheet" href="/media/system/css/modal.css" type="text/css" />
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,700,400italic" type="text/css" />
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../joomla/templates/highsoft_colorful/css/template.css" type="text/css" />
  <script src="/media/system/js/mootools-core.js" type="text/javascript"></script>
  <script src="/media/system/js/core.js" type="text/javascript"></script>
  <script src="/media/system/js/caption.js" type="text/javascript"></script>
  <script src="/media/system/js/modal.js" type="text/javascript"></script>
  <script src="../../../../../lib/jquery-1.7.2.js" type="text/javascript"></script>
  <script src="/templates/highsoft_colorful/js/jquery.cookies.2.2.0.js" type="text/javascript"></script>
  <script src="/templates/highsoft_colorful/js/slide.js" type="text/javascript"></script>
  <script type="text/javascript">
window.addEvent('load', function() {
				new JCaption('img.caption');
			});
		window.addEvent('domready', function() {

			SqueezeBox.initialize({});
			SqueezeBox.assign($$('a.modal'), {
				parse: 'rel'
			});
		});
  </script>

<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1"><link href="/templates/highsoft_colorful/images/favicon.ico" rel="shortcut icon"/><!-- Echo Header Script -->

</head>
<body id="bd" class="clearfix">
	<div id="zt-wrapper">
		<div id="zt-wrapper-inner">
						<!--Header-->
			<div id="zt-header" class="clearfix">
				<div class="container">
			        					<div id="zt-header-inner" class="row-fluid">
			            <!-- Logo -->
													<a  id="zt-logo-image"  class="span3" href="../../../../../index.html" title="Highcharts"><img src="/templates/highsoft_colorful/images/logo.svg" alt="Highcharts" /></a>
									            <!-- #Logo -->
			            <!--Mainmenu-->
			            <div id="zt-mainmenu" class="span9 pull-right" >
			                <div id="zt-mainmenu-inner" class="row-fluid">
			                    <div class="smallmenu"><div class="menusys_mega"><ul><li class="first "><a href="../../../../../about.html"  ><span>About Us</span></a></li><li class="hasChild"><a><span>Our Products</span></a><ul class="submenu"><li class="first"><a href="../../../../../products/highcharts.html"  ><span>Highcharts</span></a></li><li><a href="../../../../../products/highstock.html"  ><span>Highstock</span></a></li><li><a href="../../../../../products/highmaps.html"  ><span>Highmaps</span></a></li><li class="last"><a href="http://highslide.com/"  ><span>Highslide JS</span></a></li></ul></li><li class="last "><a href="../../../../../contact-email.html"  ><span>Contact</span></a></li></ul></div></div><div class="largemenu"><div class="menusys_mega"><ul><li class="first "><a href="../../../../../index.html"  ><span>Home</span></a></li><li class="hasChild"><a><span>Demo</span></a><ul class="submenu"><li class="first"><a href="../../../../../demo.html"  ><span>Highcharts demos</span></a></li><li><a href="../../../../../stock/demo.html"  ><span>Highstock demos</span></a></li><li class="last"><a href="../../../../../maps/demo.html"  ><span>Highmaps demo</span></a></li></ul></li><li class="hasChild"><a><span>Docs</span></a><ul class="submenu"><li class="first"><a href="../../../../../docs.html"  ><span>General Documentation</span></a></li><li><a href="http://api.highcharts.com/highcharts"  ><span>Highcharts API Reference</span></a></li><li><a href="http://api.highcharts.com/highstock"  ><span>Highstock API Reference</span></a></li><li><a href="http://api.highcharts.com/highmaps"  ><span>Highmaps API Reference</span></a></li><li><a href="../../../../../documentation/compatibility.html"  ><span>Compatibility</span></a></li><li class="last"><a href="../../../../../documentation/changelog.html"  ><span>Changelog</span></a></li></ul></li><li class="hasChild"><a><span>Support</span></a><ul class="submenu"><li class="first"><a href="../../../../../support.html"  ><span>Support</span></a></li><li><a href="../../../../../support/roadmap.html"  ><span>Roadmap</span></a></li><li><a href="../../../../../download.html"  ><span>Download</span></a></li><li class="last"><a href="http://forum.highcharts.com/"  ><span>Forum</span></a></li></ul></li><li><a href="../../../../../plugin-registry.html"  ><span>Plugins</span></a></li><li class="last "><a href="http://shop.highsoft.com/"  ><span>Shop</span></a></li></ul></div></div>			                </div>
			            </div>
			            <!--#Mainmenu-->
						<!--Drill Menu-->
						<div class="zt-drillmenu-inner">
							<div class="navbar">
								<a class="btn-navbar collapsed" id="mobile-button" data-toggle="collapse" data-target=".menusys_drill"></a>
								<div class="menusys_drill collapse"><ul id="zo2-drilldown-menu" class="nav-drilldown"><li class="first item"><a href="../../../../../index.html"  id="menusys101_drill" title="Home"><span class="menusys_name">Home</span></a></li><li class="item hasChild"><a id="menusys103_drill" title="Demo"><span class="menusys_name">Demo</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../../../../demo.html"  id="menusys106_drill" title="Highcharts demos"><span class="menusys_name">Highcharts demos</span></a></li><li class="item"><a href="../../../../../stock/demo.html"  id="menusys107_drill" title="Highstock demos"><span class="menusys_name">Highstock demos</span></a></li><li class="last item"><a href="../../../../../maps/demo.html"  id="menusys205_drill" title="Highmaps demo"><span class="menusys_name">Highmaps demo</span></a></li></ul></li><li class="item hasChild"><a id="menusys108_drill" title="Docs"><span class="menusys_name">Docs</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../../../../docs.html"  id="menusys128_drill" title="General Documentation"><span class="menusys_name">General Documentation</span></a></li><li class="item"><a href="http://api.highcharts.com/highcharts"  id="menusys124_drill" title="Highcharts API Reference"><span class="menusys_name">Highcharts API Reference</span></a></li><li class="item"><a href="http://api.highcharts.com/highstock"  id="menusys125_drill" title="Highstock API Reference"><span class="menusys_name">Highstock API Reference</span></a></li><li class="item"><a href="http://api.highcharts.com/highmaps"  id="menusys211_drill" title="Highmaps API Reference"><span class="menusys_name">Highmaps API Reference</span></a></li><li class="item"><a href="../../../../../documentation/compatibility.html"  id="menusys126_drill" title="Compatibility"><span class="menusys_name">Compatibility</span></a></li><li class="last item"><a href="../../../../../documentation/changelog.html"  id="menusys127_drill" title="Changelog"><span class="menusys_name">Changelog</span></a></li></ul></li><li class="item hasChild"><a id="menusys109_drill" title="Support"><span class="menusys_name">Support</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../../../../support.html"  id="menusys110_drill" title="Support"><span class="menusys_name">Support</span></a></li><li class="item"><a href="../../../../../support/roadmap.html"  id="menusys129_drill" title="Roadmap"><span class="menusys_name">Roadmap</span></a></li><li class="item"><a href="../../../../../download.html"  id="menusys201_drill" title="Download"><span class="menusys_name">Download</span></a></li><li class="last item"><a href="http://forum.highcharts.com/"  id="menusys208_drill" title="Forum"><span class="menusys_name">Forum</span></a></li></ul></li><li class="item"><a href="../../../../../plugin-registry.html"  id="menusys111_drill" title="Plugins"><span class="menusys_name">Plugins</span></a></li><li class="item"><a href="http://shop.highsoft.com/"  id="menusys115_drill" title="Shop"><span class="menusys_name">Shop</span></a></li><li class="item"><a href="../../../../../about.html"  id="menusys112_drill" title="About Us"><span class="menusys_name">About Us</span></a></li><li class="item hasChild"><a id="menusys113_drill" title="Our Products"><span class="menusys_name">Our Products</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../../../../products/highcharts.html"  id="menusys121_drill" title="Highcharts"><span class="menusys_name">Highcharts</span></a></li><li class="item"><a href="../../../../../products/highstock.html"  id="menusys122_drill" title="Highstock"><span class="menusys_name">Highstock</span></a></li><li class="item"><a href="../../../../../products/highmaps.html"  id="menusys210_drill" title="Highmaps"><span class="menusys_name">Highmaps</span></a></li><li class="last item"><a href="http://highslide.com/"  id="menusys123_drill" title="Highslide JS"><span class="menusys_name">Highslide JS</span></a></li></ul></li><li class="last item"><a href="../../../../../contact-email.html"  id="menusys114_drill" title="Contact"><span class="menusys_name">Contact</span></a></li></ul></div>							</div>
							<div class="clearfix"></div>
						</div>
						<!--#Drill Menu-->
					</div>
				</div>
			</div>
			<!--#Header-->
            <!--Slideshow-->
                        <!--#Slideshow-->
            			            <!-- ZT Userwrap2 -->
			            <!-- #ZT Userwrap2 -->
            <!-- ZT Userwrap3 -->
			            <!-- #ZT Userwrap3 -->
                        			<!--Main-->
						<div id="zt-mainframe" class="clearfix">
				<div class="container">
					<div id="zt-mainframe-inner" class="row-fluid clearfix">
						<div id="zt-mainframe-inner2" class="zt-container">
														<div id="zt-content" class="span12">
																<div id="zt-component" class="clearfix">
									<div id="zt-component-inner">
										
<div id="system-message-container">
</div>
										
<article class="item-page">
	
	<header class="clearfix">
		
				<h1>
							Improved image export with PhantomJS					</h1>
		
			</header>

	






<strong>We would like to announce a new release of serverside rendering by using <a href="http://phantomjs.org/">PhantomJS</a>. We newly added the option to start a webserver from the highcharts-convert.js script. This has been a successful approach and we decided to use this technique also for our featured Highcharts export server (only Java version). By using PhantomJS as headless browser in the export server, we have been able to improve performance and stability.</strong>

<h3>Serverside rendering revisited</h3>
<p><div style="position:relative; float: right;"><img src="http://www.highcharts.com/images/stories/articles/phantomjs-logo.png"/></div>With the last release of the export-server in January 2013, we already introduced serverside rendering as a new feature.  This is for creating charts on the server, without a client involved. We use PhantomJS, which emulates a browser environment (Webkit) on the server. <a href="http://phantomjs.org/">PhantomJS</a> comes with a JavaScript API and we used this for making a script for converting our graphs to another file format. In summary it works like this; the script (highcharts-convert.js) starts a browser, opens a page with Highcharts loaded in it and produces a chart and saves it as an image, PDF or SVG.</p>  
<p>PhantomJS is started from the command line with our highcharts-convert.js script as first parameter and with the other command line parameters we pass over the Highcharts configuration, the name of the output file and parameters for the graphical layout. Example usage on the commandline:
  <pre>phantomjs highcharts-convert.js -infile options.js -outfile chart.png -scale 2.5 -width 300</pre>
</p>
<p>With this you can for example use it for;
  <ol>
    <li>you want to include your charts in emails or automated management reports</li>
    <li>you want to have a consistency between graphs you present on your website and your backend produced reports</li>
</ol>
</p>
<h3>NEW: Start PhantomJS as a webserver</h3>
  <p>With this new release we enhanced the existing <a href="https://github.com/highslide-software/highcharts.com/blob/master/exporting-server/phantomjs/highcharts-convert.js">highcharts-convert.js</a> script, by making it optional to let it start a webserver. By doing so, we don't have to start a PhantomJS process over and over again for every conversion job and this results in a better performance. While running the script in webserver mode, the result isn’t saved to a file, but returned as a base64 string, unless when you want to export to SVG or PDF.
  </p> 
  <h4>How to run the script as a webserver </h4>
  <ol>
    <li>This is how you start a webserver in PhantomJS with the highcharts-convert.js script, change the host and port to your needs. However do not expose the PhantomJS webserver to the outside world, it’s not intended as a general production server.
                <pre>phantomjs highcharts-convert.js -host 127.0.0.1 -port 3003</pre></li>
    <li>The webserver listens only to POST-requests. Use the same parameters as for command line usage, but wrap them in a JSON structure. See this example for the content of a POST request;<pre>"{"infile":"{xAxis: {categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']},series: [{data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]}]};","callback":"function(chart) {chart.renderer.arc(200, 150, 100, 50, -Math.PI, 0).attr({fill : '#FCFFC5',stroke : 'black','stroke-width' : 1}).add();}","constr":"Chart","outfile":"//tmp//chart.png"}"</pre>
    </li>
 </ol>
  <p>Note that it's still possible to use the command line syntax when you don’t want to start the script as a webserver. For a more detailed explanation of how to use the script with PhantomJS read more on <a href="http://docs.highcharts.com/#render-charts-on-the-server">docs.highcharts.com</a></p>
<h3>New release for the export-server</h3>
<p>Our experience with PhantomJS have been overall positive and we decided to integrate PhantomJS in the featured Highcharts export-server. Basically we’re running the highcharts-convert.js script as a webserver and communicate with it. When the Highcharts export-server starts up we let PhantomJS start several webservers in a serverpool. This speeds up things drastically, because now we can serve requests concurrently and we benefit from not having to start a PhantomJS process for every conversion any longer.</p>
<p>Read more on installing and using the export server on <a href="http://docs.highcharts.com/#export-module">docs.highcharts.com</a></p>

<h3>Benchmarking the new server</h3>
<p>We compared generation time with the last release with the new release. The last release uses PhantomJS for generating SVG from a Highcharts configuration and it uses Batik for converting from SVG to other file formats. The new release uses only PhantomJS for converting and simplifies the whole process. Benchmark on a local machine, just for getting an impression;</p>

<table class="datatable" style="width:600px;margin-left:40px">
  
  <thead>
    <colgroup>       
    <col span="1" style="width: 20%;">
    <col span="1" style="width: 40%;">
    <col span="1" style="width: 40%;">
  </colgroup>
  <tr>
    <th>&nbsp</th>
    <th><strong>New</strong> release, using only PhantomJS,<br/> generation time in milliseconds</th>
    <th><strong>Last</strong> release using PhantomJS/Batik,<br/> generation time in milliseconds</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>Small SVG to PNG</td>
    <td>79</td>
    <td>90</td>
  </tr>
  <tr>
    <td>Large SVG to PNG</td>
    <td>566</td>
    <td>256 (faster with Batik?)</td>
  </tr>
  <tr>
    <td>Small JSON to PNG</td>
    <td>161</td>
    <td>760</td>
  </tr>
  <tr>
    <td>Large JSON to PNG</td>
    <td>821</td>
    <td>1480</td>
  </tr> 
  </tbody>
</table>

<p>We tested with a large file containing 2000 datapoints and a small file contained 12 points. Maybe you'll notice the longer generation time for larger SVG files. Well, I guess we have to run more benchmarks to draw a final conclusion about that. In all we recommend though, the Java Export server based on PhantomJS. We feel it's a more stable and repsonsive server. Not only by using PhantomJS, but also by implementing a serverpool. Your clients who use the export server, don't have to wait for eachother to get served anymore. And this is something you have to take into account to.</p> 



		
</article>
									</div>
								</div>
																							</div>
							
														<div class="clearfix"></div>
						</div>
					</div>
				</div>
			</div>
			<!--#main-->
			            <!-- ZT Userwrap6 -->
			            <!-- #ZT Userwrap6 -->
            <!-- ZT Userwrap7 -->
			            <!-- #ZT Userwrap7 -->
			<!--Footer-->
			<div id="zt-footer" class="clearfix ">
				<div class="container">
					<div id="zt-footer-inner" class="row-fluid">
						<div id="zt-footer-left" class="span6">
															
							<div id="zt-footer-copy">
							© 2014 Highcharts. All rights reserved.							</div>
						</div>
												<div id="zt-social" class="span4">
							<div>
<a href="https://www.facebook.com/Highcharts" title="Facebook" class="social-icon"><i class="fa fa-facebook"></i></a>
<a href="https://twitter.com/Highcharts" title="Twitter" class="social-icon"><i class="fa fa-twitter"></i></a>
<a href="http://www.linkedin.com/company/highsoft-solutions-as" title="LinkedIn" class="social-icon"><i class="fa fa-linkedin"></i></a>
<a href="https://github.com/highslide-software/highcharts.com" title="Github" class="social-icon"><i class="fa fa-github"></i></a>
</div>
						</div>
												<div class="clearfix"></div>
					</div>
				</div>
			</div>
            <!--#Footer-->
		</div>
	</div>
	
	    <!-- Echo Footer Script -->
        	<script type="text/javascript">
		var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
		document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
	</script>
	<script type="text/javascript">
		try {
			var pageTracker = _gat._getTracker("UA-2995052-3");
			pageTracker._trackPageview();
		} catch(err) {}
	</script>
</body>
</html>
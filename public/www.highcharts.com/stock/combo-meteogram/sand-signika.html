
<!DOCTYPE html>
<!--[if IE 8 ]><html class="ie8" lang="en-gb"> <![endif]-->
<!--[if IE 9 ]><html class="ie9" lang="en-gb"><![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en-gb"><!--<![endif]-->
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<head>
  <!--<base href="http://www.highcharts.com/stock/combo-meteogram/sand-signika" />-->
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="keywords" content="highcharts, charts, javascript charts, ajax charts, plots, line charts, bar charts, pie charts, javascript plots, ajax plots" />
  <meta name="description" content="Highcharts - Interactive JavaScript charts for your web pages." />
  <meta name="generator" content="Joomla! - Open Source Content Management" />
  <title>Highcharts - Meteogram</title>
  <link rel="stylesheet" href="/components/com_demo/assets/css/demo.css" type="text/css" />
  <link rel="stylesheet" href="/media/system/css/modal.css" type="text/css" />
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,700,400italic" type="text/css" />
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" type="text/css" />
  <link rel="stylesheet" href="../../joomla/templates/highsoft_colorful/css/template.css" type="text/css" />
  <script src="/media/system/js/mootools-core.js" type="text/javascript"></script>
  <script src="/media/system/js/core.js" type="text/javascript"></script>
  <script src="/media/system/js/modal.js" type="text/javascript"></script>
  <script src="../../lib/jquery-1.7.2.js" type="text/javascript"></script>
  <script src="/templates/highsoft_colorful/js/jquery.cookies.2.2.0.js" type="text/javascript"></script>
  <script src="/templates/highsoft_colorful/js/slide.js" type="text/javascript"></script>
  <script type="text/javascript">

		window.addEvent('domready', function() {

			SqueezeBox.initialize({});
			SqueezeBox.assign($$('a.modal'), {
				parse: 'rel'
			});
		});
  </script>

<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1"><link href="/templates/highsoft_colorful/images/favicon.ico" rel="shortcut icon"/><!-- Echo Header Script -->

</head>
<body id="bd" class="clearfix">
	<div id="zt-wrapper">
		<div id="zt-wrapper-inner">
						<!--Header-->
			<div id="zt-header" class="clearfix">
				<div class="container">
			        					<div id="zt-header-inner" class="row-fluid">
			            <!-- Logo -->
													<a  id="zt-logo-image"  class="span3" href="../../index.html" title="Highcharts"><img src="/templates/highsoft_colorful/images/logo.svg" alt="Highcharts" /></a>
									            <!-- #Logo -->
			            <!--Mainmenu-->
			            <div id="zt-mainmenu" class="span9 pull-right" >
			                <div id="zt-mainmenu-inner" class="row-fluid">
			                    <div class="smallmenu"><div class="menusys_mega"><ul><li class="first "><a href="../../about.html"  ><span>About Us</span></a></li><li class="hasChild"><a><span>Our Products</span></a><ul class="submenu"><li class="first"><a href="../../products/highcharts.html"  ><span>Highcharts</span></a></li><li><a href="../../products/highstock.html"  ><span>Highstock</span></a></li><li><a href="../../products/highmaps.html"  ><span>Highmaps</span></a></li><li class="last"><a href="http://highslide.com/"  ><span>Highslide JS</span></a></li></ul></li><li class="last "><a href="../../contact-email.html"  ><span>Contact</span></a></li></ul></div></div><div class="largemenu"><div class="menusys_mega"><ul><li class="first "><a href="../../index.html"  ><span>Home</span></a></li><li class="hasChild active"><a><span>Demo</span></a><ul class="submenu"><li class="first"><a href="../../demo.html"  ><span>Highcharts demos</span></a></li><li><a href="../demo.html"  ><span>Highstock demos</span></a></li><li class="last"><a href="../../maps/demo.html"  ><span>Highmaps demo</span></a></li></ul></li><li class="hasChild"><a><span>Docs</span></a><ul class="submenu"><li class="first"><a href="../../docs.html"  ><span>General Documentation</span></a></li><li><a href="http://api.highcharts.com/highcharts"  ><span>Highcharts API Reference</span></a></li><li><a href="http://api.highcharts.com/highstock"  ><span>Highstock API Reference</span></a></li><li><a href="http://api.highcharts.com/highmaps"  ><span>Highmaps API Reference</span></a></li><li><a href="../../documentation/compatibility.html"  ><span>Compatibility</span></a></li><li class="last"><a href="../../documentation/changelog.html"  ><span>Changelog</span></a></li></ul></li><li class="hasChild"><a><span>Support</span></a><ul class="submenu"><li class="first"><a href="../../support.html"  ><span>Support</span></a></li><li><a href="../../support/roadmap.html"  ><span>Roadmap</span></a></li><li><a href="../../download.html"  ><span>Download</span></a></li><li class="last"><a href="http://forum.highcharts.com/"  ><span>Forum</span></a></li></ul></li><li><a href="../../plugin-registry.html"  ><span>Plugins</span></a></li><li class="last "><a href="http://shop.highsoft.com/"  ><span>Shop</span></a></li></ul></div></div>			                </div>
			            </div>
			            <!--#Mainmenu-->
						<!--Drill Menu-->
						<div class="zt-drillmenu-inner">
							<div class="navbar">
								<a class="btn-navbar collapsed" id="mobile-button" data-toggle="collapse" data-target=".menusys_drill"></a>
								<div class="menusys_drill collapse"><ul id="zo2-drilldown-menu" class="nav-drilldown"><li class="first item"><a href="../../index.html"  id="menusys101_drill" title="Home"><span class="menusys_name">Home</span></a></li><li class="item hasChild active"><a id="menusys103_drill" title="Demo"><span class="menusys_name">Demo</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../demo.html"  id="menusys106_drill" title="Highcharts demos"><span class="menusys_name">Highcharts demos</span></a></li><li class="item"><a href="../demo.html"  id="menusys107_drill" title="Highstock demos"><span class="menusys_name">Highstock demos</span></a></li><li class="last item"><a href="../../maps/demo.html"  id="menusys205_drill" title="Highmaps demo"><span class="menusys_name">Highmaps demo</span></a></li></ul></li><li class="item hasChild"><a id="menusys108_drill" title="Docs"><span class="menusys_name">Docs</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../docs.html"  id="menusys128_drill" title="General Documentation"><span class="menusys_name">General Documentation</span></a></li><li class="item"><a href="http://api.highcharts.com/highcharts"  id="menusys124_drill" title="Highcharts API Reference"><span class="menusys_name">Highcharts API Reference</span></a></li><li class="item"><a href="http://api.highcharts.com/highstock"  id="menusys125_drill" title="Highstock API Reference"><span class="menusys_name">Highstock API Reference</span></a></li><li class="item"><a href="http://api.highcharts.com/highmaps"  id="menusys211_drill" title="Highmaps API Reference"><span class="menusys_name">Highmaps API Reference</span></a></li><li class="item"><a href="../../documentation/compatibility.html"  id="menusys126_drill" title="Compatibility"><span class="menusys_name">Compatibility</span></a></li><li class="last item"><a href="../../documentation/changelog.html"  id="menusys127_drill" title="Changelog"><span class="menusys_name">Changelog</span></a></li></ul></li><li class="item hasChild"><a id="menusys109_drill" title="Support"><span class="menusys_name">Support</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../support.html"  id="menusys110_drill" title="Support"><span class="menusys_name">Support</span></a></li><li class="item"><a href="../../support/roadmap.html"  id="menusys129_drill" title="Roadmap"><span class="menusys_name">Roadmap</span></a></li><li class="item"><a href="../../download.html"  id="menusys201_drill" title="Download"><span class="menusys_name">Download</span></a></li><li class="last item"><a href="http://forum.highcharts.com/"  id="menusys208_drill" title="Forum"><span class="menusys_name">Forum</span></a></li></ul></li><li class="item"><a href="../../plugin-registry.html"  id="menusys111_drill" title="Plugins"><span class="menusys_name">Plugins</span></a></li><li class="item"><a href="http://shop.highsoft.com/"  id="menusys115_drill" title="Shop"><span class="menusys_name">Shop</span></a></li><li class="item"><a href="../../about.html"  id="menusys112_drill" title="About Us"><span class="menusys_name">About Us</span></a></li><li class="item hasChild"><a id="menusys113_drill" title="Our Products"><span class="menusys_name">Our Products</span></a><a class="toggle-icon" data-target-relative=".siblings('ul')"></a><ul class="detail-parent"><li class="first item"><a href="../../products/highcharts.html"  id="menusys121_drill" title="Highcharts"><span class="menusys_name">Highcharts</span></a></li><li class="item"><a href="../../products/highstock.html"  id="menusys122_drill" title="Highstock"><span class="menusys_name">Highstock</span></a></li><li class="item"><a href="../../products/highmaps.html"  id="menusys210_drill" title="Highmaps"><span class="menusys_name">Highmaps</span></a></li><li class="last item"><a href="http://highslide.com/"  id="menusys123_drill" title="Highslide JS"><span class="menusys_name">Highslide JS</span></a></li></ul></li><li class="last item"><a href="../../contact-email.html"  id="menusys114_drill" title="Contact"><span class="menusys_name">Contact</span></a></li></ul></div>							</div>
							<div class="clearfix"></div>
						</div>
						<!--#Drill Menu-->
					</div>
				</div>
			</div>
			<!--#Header-->
            <!--Slideshow-->
                        <!--#Slideshow-->
            			            <!-- ZT Userwrap2 -->
			            <!-- #ZT Userwrap2 -->
            <!-- ZT Userwrap3 -->
			            <!-- #ZT Userwrap3 -->
                        			<!--Main-->
						<div id="zt-mainframe" class="clearfix">
				<div class="container">
					<div id="zt-mainframe-inner" class="row-fluid clearfix">
						<div id="zt-mainframe-inner2" class="zt-container">
														<div id="zt-content" class="span12">
																<div id="zt-component" class="clearfix">
									<div id="zt-component-inner">
										
<div id="system-message-container">
</div>
										<h2 class="demo-header">Demo - Meteogram</h2>
<div id="demo-component">
	<script type="text/javascript">
		jQuery.noConflict();

		var example = 'combo-meteogram', 
		theme = 'sand-signika';

		(function($){ // encapsulate jQuery
			/**
 * This is a complex demo of how to set up a Highcharts chart, coupled to a 
 * dynamic source and extended by drawing image sprites, wind arrow paths
 * and a second grid on top of the chart. The purpose of the demo is to inpire
 * developers to go beyond the basic chart types and show how the library can
 * be extended programmatically. This is what the demo does:
 *
 * - Loads weather forecast from www.yr.no in form of an XML service. The XML
 *   is translated on the Higcharts website into JSONP for the sake of the demo
 *   being shown on both our website and JSFiddle.
 * - When the data arrives async, a Meteogram instance is created. We have 
 *   created the Meteogram prototype to provide an organized structure of the different
 *   methods and subroutines associated with the demo.
 * - The parseYrData method parses the data from www.yr.no into several parallel arrays. These
 *   arrays are used directly as the data option for temperature, precipitation
 *   and air pressure. As the temperature data gives only full degrees, we apply 
 *   some smoothing on the graph, but keep the original data in the tooltip.
 * - After this, the options structure is build, and the chart generated with the 
 *   parsed data.
 * - In the callback (on chart load), we weather icons on top of the temperature series.
 *   The icons are sprites from a single PNG image, placed inside a clipped 30x30
 *   SVG <g> element. VML interprets this as HTML images inside a clipped div.
 * - Lastly, the wind arrows are built and added below the plot area, and a grid is 
 *   drawn around them. The wind arrows are basically drawn north-south, then rotated
 *   as per the wind direction.
 */

function Meteogram(xml, container) {
    // Parallel arrays for the chart data, these are populated as the XML/JSON file 
    // is loaded
    this.symbols = [];
    this.symbolNames = [];
    this.precipitations = [];
    this.windDirections = [];
    this.windDirectionNames = [];
    this.windSpeeds = [];
    this.windSpeedNames = [];
    this.temperatures = [];
    this.pressures = [];

    // Initialize
    this.xml = xml;
    this.container = container;

    // Run
    this.parseYrData();
}
/**
 * Return weather symbol sprites as laid out at http://om.yr.no/forklaring/symbol/
 */
Meteogram.prototype.getSymbolSprites = function (symbolSize) {
    return {
        '01d': {
            x: 0,
            y: 0
        },
        '01n': {
            x: symbolSize,
            y: 0
        },
        '16': {
            x: 2 * symbolSize,
            y: 0
        },
        '02d': {
            x: 0,
            y: symbolSize
        },
        '02n': {
            x: symbolSize,
            y: symbolSize
        },
        '03d': {
            x: 0,
            y: 2 * symbolSize
        },
        '03n': {
            x: symbolSize,
            y: 2 * symbolSize
        },
        '17': {
            x: 2 * symbolSize,
            y: 2 * symbolSize
        },
        '04': {
            x: 0,
            y: 3 * symbolSize
        },
        '05d': {
            x: 0,
            y: 4 * symbolSize
        },
        '05n': {
            x: symbolSize,
            y: 4 * symbolSize
        },
        '18': {
            x: 2 * symbolSize,
            y: 4 * symbolSize
        },
        '06d': {
            x: 0,
            y: 5 * symbolSize
        },
        '06n': {
            x: symbolSize,
            y: 5 * symbolSize
        },
        '07d': {
            x: 0,
            y: 6 * symbolSize
        },
        '07n': {
            x: symbolSize,
            y: 6 * symbolSize
        },
        '08d': {
            x: 0,
            y: 7 * symbolSize
        },
        '08n': {
            x: symbolSize,
            y: 7 * symbolSize
        },
        '19': {
            x: 2 * symbolSize,
            y: 7 * symbolSize
        },
        '09': {
            x: 0,
            y: 8 * symbolSize
        },
        '10': {
            x: 0,
            y: 9 * symbolSize
        },
        '11': {
            x: 0,
            y: 10 * symbolSize
        },
        '12': {
            x: 0,
            y: 11 * symbolSize
        },
        '13': {
            x: 0,
            y: 12 * symbolSize
        },
        '14': {
            x: 0,
            y: 13 * symbolSize
        },
        '15': {
            x: 0,
            y: 14 * symbolSize
        },
        '20d': {
            x: 0,
            y: 15 * symbolSize
        },
        '20n': {
            x: symbolSize,
            y: 15 * symbolSize
        },
        '20m': {
            x: 2 * symbolSize,
            y: 15 * symbolSize
        },
        '21d': {
            x: 0,
            y: 16 * symbolSize
        },
        '21n': {
            x: symbolSize,
            y: 16 * symbolSize
        },
        '21m': {
            x: 2 * symbolSize,
            y: 16 * symbolSize
        },
        '22': {
            x: 0,
            y: 17 * symbolSize
        },
        '23': {
            x: 0,
            y: 18 * symbolSize
        }
    };
};


/**
 * Function to smooth the temperature line. The original data provides only whole degrees,
 * which makes the line graph look jagged. So we apply a running mean on it, but preserve
 * the unaltered value in the tooltip.
 */
Meteogram.prototype.smoothLine = function (data) {
    var i = data.length,
        sum,
        value;

    while (i--) {
        data[i].value = value = data[i].y; // preserve value for tooltip

        // Set the smoothed value to the average of the closest points, but don't allow
        // it to differ more than 0.5 degrees from the given value
        sum = (data[i - 1] || data[i]).y + value + (data[i + 1] || data[i]).y;
        data[i].y = Math.max(value - 0.5, Math.min(sum / 3, value + 0.5));
    }
};

/**
 * Callback function that is called from Highcharts on hovering each point and returns
 * HTML for the tooltip.
 */
Meteogram.prototype.tooltipFormatter = function (tooltip) {

    // Create the header with reference to the time interval
    var index = tooltip.points[0].point.index,
        ret = '<small>' + Highcharts.dateFormat('%A, %b %e, %H:%M', tooltip.x) + '-' +
            Highcharts.dateFormat('%H:%M', tooltip.points[0].point.to) + '</small><br>';

    // Symbol text
    ret += '<b>' + this.symbolNames[index] + '</b>';

    ret += '<table>';

    // Add all series
    Highcharts.each(tooltip.points, function (point) {
        var series = point.series;
        ret += '<tr><td><span style="color:' + series.color + '">\u25CF</span> ' + series.name +
            ': </td><td style="white-space:nowrap">' + Highcharts.pick(point.point.value, point.y) +
            series.options.tooltip.valueSuffix + '</td></tr>';
    });

    // Add wind
    ret += '<tr><td style="vertical-align: top">\u25CF Wind</td><td style="white-space:nowrap">' + this.windDirectionNames[index] +
        '<br>' + this.windSpeedNames[index] + ' (' +
        Highcharts.numberFormat(this.windSpeeds[index], 1) + ' m/s)</td></tr>';

    // Close
    ret += '</table>';


    return ret;
};

/**
 * Draw the weather symbols on top of the temperature series. The symbols are sprites of a single
 * file, defined in the getSymbolSprites function above.
 */
Meteogram.prototype.drawWeatherSymbols = function (chart) {
    var meteogram = this,
        symbolSprites = this.getSymbolSprites(30);

    $.each(chart.series[0].data, function(i, point) {
        var sprite,
            group;

        if (meteogram.resolution > 36e5 || i % 2 === 0) {

            sprite = symbolSprites[meteogram.symbols[i]];
            if (sprite) {

                // Create a group element that is positioned and clipped at 30 pixels width and height
                group = chart.renderer.g()
                    .attr({
                        translateX: point.plotX + chart.plotLeft - 15,
                        translateY: point.plotY + chart.plotTop - 30,
                        zIndex: 5
                    })
                    .clip(chart.renderer.clipRect(0, 0, 30, 30))
                    .add();

                // Position the image inside it at the sprite position
                chart.renderer.image(
                    'http://www.highcharts.com/samples/graphics/meteogram-symbols-30px.png',
                    -sprite.x,
                    -sprite.y,
                    90,
                    570
                )
                    .add(group);
            }
        }
    });
};

/**
 * Create wind speed symbols for the Beaufort wind scale. The symbols are rotated
 * around the zero centerpoint.
 */
Meteogram.prototype.windArrow = function (name) {
    var level,
        path;

    // The stem and the arrow head
    path = [
        'M', 0, 7, // base of arrow
        'L', -1.5, 7,
        0, 10,
        1.5, 7,
        0, 7,
        0, -10 // top
    ];

    level = $.inArray(name, ['Calm', 'Light air', 'Light breeze', 'Gentle breeze', 'Moderate breeze',
        'Fresh breeze', 'Strong breeze', 'Near gale', 'Gale', 'Strong gale', 'Storm',
        'Violent storm', 'Hurricane']);

    if (level === 0) {
        path = [];
    }

    if (level === 2) {
        path.push('M', 0, -8, 'L', 4, -8); // short line
    } else if (level >= 3) {
        path.push(0, -10, 7, -10); // long line
    }

    if (level === 4) {
        path.push('M', 0, -7, 'L', 4, -7);
    } else if (level >= 5) {
        path.push('M', 0, -7, 'L', 7, -7);
    }

    if (level === 5) {
        path.push('M', 0, -4, 'L', 4, -4);
    } else if (level >= 6) {
        path.push('M', 0, -4, 'L', 7, -4);
    }

    if (level === 7) {
        path.push('M', 0, -1, 'L', 4, -1);
    } else if (level >= 8) {
        path.push('M', 0, -1, 'L', 7, -1);
    }

    return path;
};

/**
 * Draw the wind arrows. Each arrow path is generated by the windArrow function above.
 */
Meteogram.prototype.drawWindArrows = function (chart) {
    var meteogram = this;

    $.each(chart.series[0].data, function(i, point) {
        var sprite, arrow, x, y;
        
        if (meteogram.resolution > 36e5 || i % 2 === 0) {
            
            // Draw the wind arrows
            x = point.plotX + chart.plotLeft + 7;
            y = 255;
            if (meteogram.windSpeedNames[i] === 'Calm') {
                arrow = chart.renderer.circle(x, y, 10).attr({
                    fill: 'none'
                });
            } else {
                arrow = chart.renderer.path(
                    meteogram.windArrow(meteogram.windSpeedNames[i])
                ).attr({
                    rotation: parseInt(meteogram.windDirections[i], 10),
                    translateX: x, // rotation center
                    translateY: y // rotation center
                });
            }
            arrow.attr({
                stroke: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black',
                'stroke-width': 1.5,
                zIndex: 5
            })
            .add();

        }
    });
};

/** 
 * Draw blocks around wind arrows, below the plot area
 */
Meteogram.prototype.drawBlocksForWindArrows = function (chart) {
    var xAxis = chart.xAxis[0],
        x,
        pos,
        max,
        isLong,
        isLast,
        i;

    for (pos = xAxis.min, max = xAxis.max, i = 0; pos <= max + 36e5; pos += 36e5, i ++) {
        
        // Get the X position
        isLast = pos === max + 36e5;
        x = Math.round(xAxis.toPixels(pos)) + (isLast ? 0.5 : -0.5);
        
        // Draw the vertical dividers and ticks
        if (this.resolution > 36e5) {
            isLong = pos % this.resolution === 0;
        } else {
            isLong = i % 2 === 0;
        }
        chart.renderer.path(['M', x, chart.plotTop + chart.plotHeight + (isLong ? 0 : 28),
            'L', x, chart.plotTop + chart.plotHeight + 32, 'Z'])
            .attr({
                'stroke': chart.options.chart.plotBorderColor,
                'stroke-width': 1
            })
            .add();
    }
};

/**
 * Get the title based on the XML data
 */
Meteogram.prototype.getTitle = function () {
    return 'Meteogram for '+ this.xml.location.name +', '+ this.xml.location.country;
};

/**
 * Build and return the Highcharts options structure
 */
Meteogram.prototype.getChartOptions = function () {
    var meteogram = this;

    return {
        chart: {
            renderTo: this.container,
            marginBottom: 70,
            marginRight: 40,
            marginTop: 50,
            plotBorderWidth: 1,
            width: 800,
            height: 310
        },
        
        title: {
            text: this.getTitle(),
            align: 'left'
        },
        
        credits: {
            text: 'Forecast from <a href="http://yr.no">yr.no</a>',
            href: this.xml.credit.link['@attributes'].url,
            position: {
                x: -40
            }
        },
        
        tooltip: {
            shared: true,
            useHTML: true,
            formatter: function () { 
                return meteogram.tooltipFormatter(this); 
            }
        },
        
        xAxis: [{ // Bottom X axis
            type: 'datetime',
            tickInterval: 2 * 36e5, // two hours
            minorTickInterval: 36e5, // one hour
            tickLength: 0,
            gridLineWidth: 1,
            gridLineColor: (Highcharts.theme && Highcharts.theme.background2) || '#F0F0F0',
            startOnTick: false,
            endOnTick: false,
            minPadding: 0,
            maxPadding: 0,
            offset: 30,
            showLastLabel: true,
            labels: {
                format: '{value:%H}'
            }
        }, { // Top X axis
            linkedTo: 0,
            type: 'datetime',
            tickInterval: 24 * 3600 * 1000,
            labels: {
                format: '{value:<span style="font-size: 12px; font-weight: bold">%a</span> %b %e}',
                align: 'left',
                x: 3,
                y: -5
            },
            opposite: true,
            tickLength: 20,
            gridLineWidth: 1
        }],
        
        yAxis: [{ // temperature axis
            title: {
                text: null
            },
            labels: {
                format: '{value}°',
                style: {
                    fontSize: '10px'
                },
                x: -3
            },
            plotLines: [{ // zero plane
                value: 0,
                color: '#BBBBBB',
                width: 1,
                zIndex: 2
            }],
            // Custom positioner to provide even temperature ticks from top down
            tickPositioner: function () {
                var max = Math.ceil(this.max) + 1,
                    pos = max - 12, // start
                    ret;

                if (pos < this.min) {
                    ret = [];
                    while (pos <= max) {
                        ret.push(pos++);
                    }
                } // else return undefined and go auto

                return ret;

            },
            maxPadding: 0.3,
            tickInterval: 1,
            gridLineColor: (Highcharts.theme && Highcharts.theme.background2) || '#F0F0F0'
            
        }, { // precipitation axis
            title: {
                text: null
            },
            labels: {
                enabled: false
            },
            gridLineWidth: 0,
            tickLength: 0
        
        }, { // Air pressure
            allowDecimals: false,
            title: { // Title on top of axis
                text: 'hPa',
                offset: 0,
                align: 'high',
                rotation: 0,
                style: {
                    fontSize: '10px',
                    color: Highcharts.getOptions().colors[2]                         
                },
                textAlign: 'left',
                x: 3
            },
            labels: {
                style: {
                    fontSize: '8px',
                    color: Highcharts.getOptions().colors[2] 
                },
                y: 2,
                x: 3
            },
            gridLineWidth: 0,
            opposite: true,
            showLastLabel: false
        }],
        
        legend: {
            enabled: false
        },

        plotOptions: {
            series: {
                pointPlacement: 'between'
            }
        },
        
        
        series: [{
            name: 'Temperature',
            data: this.temperatures,
            type: 'spline',
            marker: {
                enabled: false,
                states: {
                    hover: {
                        enabled: true
                    }
                }
            },
            tooltip: {
                valueSuffix: '°C'
            },
            zIndex: 1,
            color: '#FF3333',
            negativeColor: '#48AFE8'
        }, {
            name: 'Precipitation',
            data: this.precipitations,
            type: 'column',
            color: '#68CFE8',
            yAxis: 1,
            groupPadding: 0,
            pointPadding: 0,
            borderWidth: 0,
            shadow: false,
            dataLabels: {
                enabled: true,
                formatter: function () {
                    if (this.y > 0) {
                        return this.y;
                    }
                },
                style: {
                    fontSize: '8px'
                }
            },
            tooltip: {
                valueSuffix: 'mm'
            }
        }, {
            name: 'Air pressure',
            color: Highcharts.getOptions().colors[2],
            data: this.pressures,
            marker: {
                enabled: false
            },
            shadow: false,
            tooltip: {
                valueSuffix: ' hPa'
            },
            dashStyle: 'shortdot',
            yAxis: 2
        }]
    }
};

/** 
 * Post-process the chart from the callback function, the second argument to Highcharts.Chart.
 */
Meteogram.prototype.onChartLoad = function (chart) {

    this.drawWeatherSymbols(chart);
    this.drawWindArrows(chart);
    this.drawBlocksForWindArrows(chart);

};

/**
 * Create the chart. This function is called async when the data file is loaded and parsed.
 */
Meteogram.prototype.createChart = function () {
    var meteogram = this;
    this.chart = new Highcharts.Chart(this.getChartOptions(), function (chart) {
        meteogram.onChartLoad(chart);
    });
};

/**
 * Handle the data. This part of the code is not Highcharts specific, but deals with yr.no's
 * specific data format
 */
Meteogram.prototype.parseYrData = function () {

    var meteogram = this,
        xml = this.xml,
        pointStart;

    if (!xml || !xml.forecast) {
        $('#loading').html('<i class="fa fa-frown-o"></i> Failed loading data, please try again later');
        return;
    }

    // The returned xml variable is a JavaScript representation of the provided XML, 
    // generated on the server by running PHP simple_load_xml and converting it to 
    // JavaScript by json_encode.
    $.each(xml.forecast.tabular.time, function(i, time) {
        // Get the times - only Safari can't parse ISO8601 so we need to do some replacements 
        var from = time['@attributes'].from +' UTC',
            to = time['@attributes'].to +' UTC';

        from = from.replace(/-/g, '/').replace('T', ' ');
        from = Date.parse(from);
        to = to.replace(/-/g, '/').replace('T', ' ');
        to = Date.parse(to);
        
        if (to > pointStart + 4 * 24 * 36e5) {
            return;
        }
        
        // If it is more than an hour between points, show all symbols
        if (i === 0) {
            meteogram.resolution = to - from;
        }

        // Populate the parallel arrays
        meteogram.symbols.push(time.symbol['@attributes']['var'].match(/[0-9]{2}[dnm]?/)[0]);
        meteogram.symbolNames.push(time.symbol['@attributes'].name);

        meteogram.temperatures.push({
            x: from,
            y: parseInt(time.temperature['@attributes'].value),
            // custom options used in the tooltip formatter
            to: to,
            index: i
        });

        meteogram.precipitations.push({
            x: from,
            y: parseFloat(time.precipitation['@attributes'].value)
        });
        meteogram.windDirections.push(parseFloat(time.windDirection['@attributes'].deg));
        meteogram.windDirectionNames.push(time.windDirection['@attributes'].name);
        meteogram.windSpeeds.push(parseFloat(time.windSpeed['@attributes'].mps));
        meteogram.windSpeedNames.push(time.windSpeed['@attributes'].name);

        meteogram.pressures.push({
            x: from,
            y: parseFloat(time.pressure['@attributes'].value)
        });
        
        if (i == 0) {
            pointStart = (from + to) / 2;
        }    
    });

    // Smooth the line
    this.smoothLine(this.temperatures);
    
    // Create the chart when the data is loaded
    this.createChart();
};
// End of the Meteogram protype



$(function() { // On DOM ready...
    
    // Set the hash to the yr.no URL we want to parse
    if (!location.hash) {
        var place = 'United_Kingdom/England/London';
        //place = 'France/Rhône-Alpes/Val_d\'Isère~2971074';
        //place = 'Norway/Sogn_og_Fjordane/Vik/Målset';
        //place = 'United_States/California/San_Francisco';
        //place = 'United_States/Minnesota/Minneapolis';
        location.hash = 'http://www.yr.no/place/' + place + '/forecast_hour_by_hour.xml';

    }

    // Then get the XML file through Highcharts' jsonp provider, see 
    // https://github.com/highslide-software/highcharts.com/blob/master/samples/data/jsonp.php
    // for source code.
    $.getJSON(
        'http://www.highcharts.com/samples/data/jsonp.php?url=' + location.hash.substr(1) + '&callback=?', 
        function (xml) {
            var meteogram = new Meteogram(xml, 'container');
        }
    );

});		})(jQuery);
	</script>
	<div id="demo-menu">
		<div id="demo-menu-inner">
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						Line charts					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../line-basic/sand-signika.html">
								Basic line							</a>
						</li>
												<li class="">
							<a href="../line-ajax/sand-signika.html">
								Ajax loaded data, clickable points							</a>
						</li>
												<li class="">
							<a href="../line-labels/sand-signika.html">
								With data labels							</a>
						</li>
												<li class="">
							<a href="../line-time-series/sand-signika.html">
								Time series, zoomable							</a>
						</li>
												<li class="">
							<a href="../spline-inverted/sand-signika.html">
								Spline with inverted axes							</a>
						</li>
												<li class="">
							<a href="../spline-symbols/sand-signika.html">
								Spline with symbols							</a>
						</li>
												<li class="">
							<a href="../spline-plot-bands/sand-signika.html">
								Spline with plot bands							</a>
						</li>
												<li class="">
							<a href="../spline-irregular-time/sand-signika.html">
								Time data with irregular intervals							</a>
						</li>
												<li class="">
							<a href="../line-log-axis/sand-signika.html">
								Logarithmic axis							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						Area charts					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../area-basic/sand-signika.html">
								Basic area							</a>
						</li>
												<li class="">
							<a href="../area-negative/sand-signika.html">
								Area with negative values							</a>
						</li>
												<li class="">
							<a href="../area-stacked/sand-signika.html">
								Stacked area							</a>
						</li>
												<li class="">
							<a href="../area-stacked-percent/sand-signika.html">
								Percentage area							</a>
						</li>
												<li class="">
							<a href="../area-missing/sand-signika.html">
								Area with missing points							</a>
						</li>
												<li class="">
							<a href="../area-inverted/sand-signika.html">
								Inverted axes							</a>
						</li>
												<li class="">
							<a href="../areaspline/sand-signika.html">
								Area-spline							</a>
						</li>
												<li class="">
							<a href="../arearange/sand-signika.html">
								Area range							</a>
						</li>
												<li class="">
							<a href="../arearange-line/sand-signika.html">
								Area range and line							</a>
						</li>
												<li class="">
							<a href="../sparkline/sand-signika.html">
								Sparkline charts							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						Column and bar charts					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../bar-basic/sand-signika.html">
								Basic bar							</a>
						</li>
												<li class="">
							<a href="../bar-stacked/sand-signika.html">
								Stacked bar							</a>
						</li>
												<li class="">
							<a href="../bar-negative-stack/sand-signika.html">
								Bar with negative stack							</a>
						</li>
												<li class="">
							<a href="../column-basic/sand-signika.html">
								Basic column							</a>
						</li>
												<li class="">
							<a href="../column-negative/sand-signika.html">
								Column with negative values							</a>
						</li>
												<li class="">
							<a href="../column-stacked/sand-signika.html">
								Stacked column							</a>
						</li>
												<li class="">
							<a href="../column-stacked-and-grouped/sand-signika.html">
								Stacked and grouped column							</a>
						</li>
												<li class="">
							<a href="../column-stacked-percent/sand-signika.html">
								Stacked percentage column							</a>
						</li>
												<li class="">
							<a href="../column-rotated-labels/sand-signika.html">
								Column with rotated labels							</a>
						</li>
												<li class="">
							<a href="../column-drilldown/sand-signika.html">
								Column with drilldown							</a>
						</li>
												<li class="">
							<a href="../column-placement/sand-signika.html">
								Fixed placement columns							</a>
						</li>
												<li class="">
							<a href="../column-parsed/sand-signika.html">
								Data defined in a HTML table							</a>
						</li>
												<li class="">
							<a href="../columnrange/sand-signika.html">
								Column range							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						Pie charts					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../pie-basic/sand-signika.html">
								Pie chart							</a>
						</li>
												<li class="">
							<a href="../pie-legend/sand-signika.html">
								Pie with legend							</a>
						</li>
												<li class="">
							<a href="../pie-donut/sand-signika.html">
								Donut chart							</a>
						</li>
												<li class="">
							<a href="../pie-semi-circle/sand-signika.html">
								Semi circle donut							</a>
						</li>
												<li class="">
							<a href="../pie-drilldown/sand-signika.html">
								Pie with drilldown							</a>
						</li>
												<li class="">
							<a href="../pie-gradient/sand-signika.html">
								Pie with gradient fill							</a>
						</li>
												<li class="">
							<a href="../pie-monochrome/sand-signika.html">
								Pie with monochrome fill							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						Scatter and bubble charts					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../scatter/sand-signika.html">
								Scatter plot							</a>
						</li>
												<li class="">
							<a href="../bubble/sand-signika.html">
								Bubble chart							</a>
						</li>
												<li class="">
							<a href="../bubble-3d/sand-signika.html">
								3D bubbles							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						Dynamic charts					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../dynamic-update/sand-signika.html">
								Spline updating each second							</a>
						</li>
												<li class="">
							<a href="../dynamic-click-to-add/sand-signika.html">
								Click to add a point							</a>
						</li>
												<li class="">
							<a href="../dynamic-master-detail/sand-signika.html">
								Master-detail chart							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  active">
				<h4 class="menu-toggle active">
					<span class="toggle-text">
						Combinations					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content active">
					<ul>
												<li class="">
							<a href="../combo/sand-signika.html">
								Column, line and pie							</a>
						</li>
												<li class="">
							<a href="../combo-dual-axes/sand-signika.html">
								Dual axes, line and column							</a>
						</li>
												<li class="">
							<a href="../combo-multi-axes/sand-signika.html">
								Multiple axes							</a>
						</li>
												<li class="">
							<a href="../combo-regression/sand-signika.html">
								Scatter with regression line							</a>
						</li>
												<li class="active">
							<a href="sand-signika.html">
								Meteogram							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						3D charts					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../3d-column-interactive/sand-signika.html">
								3D column							</a>
						</li>
												<li class="">
							<a href="../3d-column-null-values/sand-signika.html">
								3D column with null and 0 values							</a>
						</li>
												<li class="">
							<a href="../3d-column-stacking-grouping/sand-signika.html">
								3D column with stacking and grouping							</a>
						</li>
												<li class="">
							<a href="../3d-pie/sand-signika.html">
								3D pie							</a>
						</li>
												<li class="">
							<a href="../3d-pie-donut/sand-signika.html">
								3D donut							</a>
						</li>
												<li class="">
							<a href="../3d-scatter-draggable/sand-signika.html">
								3D scatter chart							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						Gauges					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../gauge-speedometer/sand-signika.html">
								Angular gauge							</a>
						</li>
												<li class="">
							<a href="../gauge-solid/sand-signika.html">
								Solid gauge							</a>
						</li>
												<li class="">
							<a href="../gauge-clock/sand-signika.html">
								Clock							</a>
						</li>
												<li class="">
							<a href="../gauge-dual/sand-signika.html">
								Gauge with dual axes							</a>
						</li>
												<li class="">
							<a href="../gauge-vu-meter/sand-signika.html">
								VU meter							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						Heat maps					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../heatmap/sand-signika.html">
								Heat map							</a>
						</li>
												<li class="">
							<a href="../heatmap-canvas/sand-signika.html">
								Large heat map							</a>
						</li>
											</ul>
				</div>
			</div>
						<div class="demo-menu-item  ">
				<h4 class="menu-toggle ">
					<span class="toggle-text">
						More chart types					</span>
					<span><icon class="toggle-icon"></icon></span>
					<div class="clearfix"></div>
				</h4>
				<div class="menu-content ">
					<ul>
												<li class="">
							<a href="../polar/sand-signika.html">
								Polar chart							</a>
						</li>
												<li class="">
							<a href="../polar-spider/sand-signika.html">
								Spiderweb							</a>
						</li>
												<li class="">
							<a href="../polar-wind-rose/sand-signika.html">
								Wind rose							</a>
						</li>
												<li class="">
							<a href="../box-plot/sand-signika.html">
								Box plot							</a>
						</li>
												<li class="">
							<a href="../error-bar/sand-signika.html">
								Error bar							</a>
						</li>
												<li class="">
							<a href="../waterfall/sand-signika.html">
								Waterfall							</a>
						</li>
												<li class="">
							<a href="../funnel/sand-signika.html">
								Funnel chart							</a>
						</li>
												<li class="">
							<a href="../pyramid/sand-signika.html">
								Pyramid chart							</a>
						</li>
												<li class="">
							<a href="../renderer/sand-signika.html">
								General drawing							</a>
						</li>
											</ul>
				</div>
			</div>
					</div>
	</div>
	<div id="demo-content">
		<div id="demo-content-container">
			<div id="chart-switcher">
									<a id="previous-example" title="Previous (arrow left)" 
						href="../combo-regression/sand-signika.html"><i class="fa fa-angle-left"></i></a>
									<span id="chart-title">Meteogram</span>
				
									<a id="next-example"  title="Next (arrow right)"
						href="../3d-column-interactive/sand-signika.html"><i class="fa fa-angle-right"></i></a>
							</div>
			<div id="styleswitcher">
				<ul>
					<li class=""><a href="../combo-meteogram.html">Default theme</a></li>
					<li class=""><a href="dark-unica.html">Dark Unica</a></li>
					<li class="active"><a href="sand-signika.html">Sand Signika</a></li>
					<li class=""><a href="grid-light.html">Grid Light</a></li>
				</ul>
				<div class="clearfix"></div>
			</div>
			<div id="small-switcher">
				<a class="button" id="view-menu" onclick="">Menu &raquo;</a>

				<select id="switcher-selector">
					<option value="http://www.highcharts.com/stock/combo-meteogram" >Default theme</option>
					<option value="dark-unica.html" >Dark Unica</option>
					<option value="http://www.highcharts.com/stock/combo-meteogram/sand-signika" selected>Sand Signika</option>
					<option value="grid-light.html" >Grid Light</option>
				</select>
				<div class="clearfix"></div>
			</div>
			<div id="demo-chart">
				
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

<div id="container" style="width: 800px; height: 310px; margin: 0 auto">
	<div style="margin-top: 100px; text-align: center" id="loading">
		<i class="fa fa-spinner fa-spin"></i> Loading data from external source
	</div>
</div>
<!--
<div style="width: 800px; margin: 0 auto">
	<a href="#http://www.yr.no/place/United_Kingdom/England/London/forecast_hour_by_hour.xml">London</a>,
	<a href="#http://www.yr.no/place/France/Rhône-Alpes/Val_d\'Isère~2971074/forecast_hour_by_hour.xml">Val d'Isère</a>,
	<a href="#http://www.yr.no/place/United_States/California/San_Francisco/forecast_hour_by_hour.xml">San Francisco</a>,
	<a href="#http://www.yr.no/place/Norway/Vik/Vikafjell/forecast_hour_by_hour.xml">Vikjafjellet</a>
</div>
-->			</div>
			<div id="demo-buttons">
				<a class="button" href="javascript:" 
					onclick="hs.htmlExpand(this, { width: 800,
						headingText: 'Highcharts Configuration Preview', 
						wrapperClassName: 'draggable-header' })">View options &raquo;</a>
				<div class="highslide-maincontent">
					<pre>/**
 * This is a complex demo of how to set up a Highcharts chart, coupled to a 
 * dynamic source and extended by drawing image sprites, wind arrow paths
 * and a second grid on top of the chart. The purpose of the demo is to inpire
 * developers to go beyond the basic chart types and show how the library can
 * be extended programmatically. This is what the demo does:
 *
 * - Loads weather forecast from www.yr.no in form of an XML service. The XML
 *   is translated on the Higcharts website into JSONP for the sake of the demo
 *   being shown on both our website and JSFiddle.
 * - When the data arrives async, a Meteogram instance is created. We have 
 *   created the Meteogram prototype to provide an organized structure of the different
 *   methods and subroutines associated with the demo.
 * - The parseYrData method parses the data from www.yr.no into several parallel arrays. These
 *   arrays are used directly as the data option for temperature, precipitation
 *   and air pressure. As the temperature data gives only full degrees, we apply 
 *   some smoothing on the graph, but keep the original data in the tooltip.
 * - After this, the options structure is build, and the chart generated with the 
 *   parsed data.
 * - In the callback (on chart load), we weather icons on top of the temperature series.
 *   The icons are sprites from a single PNG image, placed inside a clipped 30x30
 *   SVG &lt;g&gt; element. VML interprets this as HTML images inside a clipped div.
 * - Lastly, the wind arrows are built and added below the plot area, and a grid is 
 *   drawn around them. The wind arrows are basically drawn north-south, then rotated
 *   as per the wind direction.
 */

function Meteogram(xml, container) {
    // Parallel arrays for the chart data, these are populated as the XML/JSON file 
    // is loaded
    this.symbols = [];
    this.symbolNames = [];
    this.precipitations = [];
    this.windDirections = [];
    this.windDirectionNames = [];
    this.windSpeeds = [];
    this.windSpeedNames = [];
    this.temperatures = [];
    this.pressures = [];

    // Initialize
    this.xml = xml;
    this.container = container;

    // Run
    this.parseYrData();
}
/**
 * Return weather symbol sprites as laid out at http://om.yr.no/forklaring/symbol/
 */
Meteogram.prototype.getSymbolSprites = function (symbolSize) {
    return {
        '01d': {
            x: 0,
            y: 0
        },
        '01n': {
            x: symbolSize,
            y: 0
        },
        '16': {
            x: 2 * symbolSize,
            y: 0
        },
        '02d': {
            x: 0,
            y: symbolSize
        },
        '02n': {
            x: symbolSize,
            y: symbolSize
        },
        '03d': {
            x: 0,
            y: 2 * symbolSize
        },
        '03n': {
            x: symbolSize,
            y: 2 * symbolSize
        },
        '17': {
            x: 2 * symbolSize,
            y: 2 * symbolSize
        },
        '04': {
            x: 0,
            y: 3 * symbolSize
        },
        '05d': {
            x: 0,
            y: 4 * symbolSize
        },
        '05n': {
            x: symbolSize,
            y: 4 * symbolSize
        },
        '18': {
            x: 2 * symbolSize,
            y: 4 * symbolSize
        },
        '06d': {
            x: 0,
            y: 5 * symbolSize
        },
        '06n': {
            x: symbolSize,
            y: 5 * symbolSize
        },
        '07d': {
            x: 0,
            y: 6 * symbolSize
        },
        '07n': {
            x: symbolSize,
            y: 6 * symbolSize
        },
        '08d': {
            x: 0,
            y: 7 * symbolSize
        },
        '08n': {
            x: symbolSize,
            y: 7 * symbolSize
        },
        '19': {
            x: 2 * symbolSize,
            y: 7 * symbolSize
        },
        '09': {
            x: 0,
            y: 8 * symbolSize
        },
        '10': {
            x: 0,
            y: 9 * symbolSize
        },
        '11': {
            x: 0,
            y: 10 * symbolSize
        },
        '12': {
            x: 0,
            y: 11 * symbolSize
        },
        '13': {
            x: 0,
            y: 12 * symbolSize
        },
        '14': {
            x: 0,
            y: 13 * symbolSize
        },
        '15': {
            x: 0,
            y: 14 * symbolSize
        },
        '20d': {
            x: 0,
            y: 15 * symbolSize
        },
        '20n': {
            x: symbolSize,
            y: 15 * symbolSize
        },
        '20m': {
            x: 2 * symbolSize,
            y: 15 * symbolSize
        },
        '21d': {
            x: 0,
            y: 16 * symbolSize
        },
        '21n': {
            x: symbolSize,
            y: 16 * symbolSize
        },
        '21m': {
            x: 2 * symbolSize,
            y: 16 * symbolSize
        },
        '22': {
            x: 0,
            y: 17 * symbolSize
        },
        '23': {
            x: 0,
            y: 18 * symbolSize
        }
    };
};


/**
 * Function to smooth the temperature line. The original data provides only whole degrees,
 * which makes the line graph look jagged. So we apply a running mean on it, but preserve
 * the unaltered value in the tooltip.
 */
Meteogram.prototype.smoothLine = function (data) {
    var i = data.length,
        sum,
        value;

    while (i--) {
        data[i].value = value = data[i].y; // preserve value for tooltip

        // Set the smoothed value to the average of the closest points, but don't allow
        // it to differ more than 0.5 degrees from the given value
        sum = (data[i - 1] || data[i]).y + value + (data[i + 1] || data[i]).y;
        data[i].y = Math.max(value - 0.5, Math.min(sum / 3, value + 0.5));
    }
};

/**
 * Callback function that is called from Highcharts on hovering each point and returns
 * HTML for the tooltip.
 */
Meteogram.prototype.tooltipFormatter = function (tooltip) {

    // Create the header with reference to the time interval
    var index = tooltip.points[0].point.index,
        ret = '&lt;small&gt;' + Highcharts.dateFormat('%A, %b %e, %H:%M', tooltip.x) + '-' +
            Highcharts.dateFormat('%H:%M', tooltip.points[0].point.to) + '&lt;/small&gt;&lt;br&gt;';

    // Symbol text
    ret += '&lt;b&gt;' + this.symbolNames[index] + '&lt;/b&gt;';

    ret += '&lt;table&gt;';

    // Add all series
    Highcharts.each(tooltip.points, function (point) {
        var series = point.series;
        ret += '&lt;tr&gt;&lt;td&gt;&lt;span style="color:' + series.color + '"&gt;\u25CF&lt;/span&gt; ' + series.name +
            ': &lt;/td&gt;&lt;td style="white-space:nowrap"&gt;' + Highcharts.pick(point.point.value, point.y) +
            series.options.tooltip.valueSuffix + '&lt;/td&gt;&lt;/tr&gt;';
    });

    // Add wind
    ret += '&lt;tr&gt;&lt;td style="vertical-align: top"&gt;\u25CF Wind&lt;/td&gt;&lt;td style="white-space:nowrap"&gt;' + this.windDirectionNames[index] +
        '&lt;br&gt;' + this.windSpeedNames[index] + ' (' +
        Highcharts.numberFormat(this.windSpeeds[index], 1) + ' m/s)&lt;/td&gt;&lt;/tr&gt;';

    // Close
    ret += '&lt;/table&gt;';


    return ret;
};

/**
 * Draw the weather symbols on top of the temperature series. The symbols are sprites of a single
 * file, defined in the getSymbolSprites function above.
 */
Meteogram.prototype.drawWeatherSymbols = function (chart) {
    var meteogram = this,
        symbolSprites = this.getSymbolSprites(30);

    $.each(chart.series[0].data, function(i, point) {
        var sprite,
            group;

        if (meteogram.resolution &gt; 36e5 || i % 2 === 0) {

            sprite = symbolSprites[meteogram.symbols[i]];
            if (sprite) {

                // Create a group element that is positioned and clipped at 30 pixels width and height
                group = chart.renderer.g()
                    .attr({
                        translateX: point.plotX + chart.plotLeft - 15,
                        translateY: point.plotY + chart.plotTop - 30,
                        zIndex: 5
                    })
                    .clip(chart.renderer.clipRect(0, 0, 30, 30))
                    .add();

                // Position the image inside it at the sprite position
                chart.renderer.image(
                    'http://www.highcharts.com/samples/graphics/meteogram-symbols-30px.png',
                    -sprite.x,
                    -sprite.y,
                    90,
                    570
                )
                    .add(group);
            }
        }
    });
};

/**
 * Create wind speed symbols for the Beaufort wind scale. The symbols are rotated
 * around the zero centerpoint.
 */
Meteogram.prototype.windArrow = function (name) {
    var level,
        path;

    // The stem and the arrow head
    path = [
        'M', 0, 7, // base of arrow
        'L', -1.5, 7,
        0, 10,
        1.5, 7,
        0, 7,
        0, -10 // top
    ];

    level = $.inArray(name, ['Calm', 'Light air', 'Light breeze', 'Gentle breeze', 'Moderate breeze',
        'Fresh breeze', 'Strong breeze', 'Near gale', 'Gale', 'Strong gale', 'Storm',
        'Violent storm', 'Hurricane']);

    if (level === 0) {
        path = [];
    }

    if (level === 2) {
        path.push('M', 0, -8, 'L', 4, -8); // short line
    } else if (level &gt;= 3) {
        path.push(0, -10, 7, -10); // long line
    }

    if (level === 4) {
        path.push('M', 0, -7, 'L', 4, -7);
    } else if (level &gt;= 5) {
        path.push('M', 0, -7, 'L', 7, -7);
    }

    if (level === 5) {
        path.push('M', 0, -4, 'L', 4, -4);
    } else if (level &gt;= 6) {
        path.push('M', 0, -4, 'L', 7, -4);
    }

    if (level === 7) {
        path.push('M', 0, -1, 'L', 4, -1);
    } else if (level &gt;= 8) {
        path.push('M', 0, -1, 'L', 7, -1);
    }

    return path;
};

/**
 * Draw the wind arrows. Each arrow path is generated by the windArrow function above.
 */
Meteogram.prototype.drawWindArrows = function (chart) {
    var meteogram = this;

    $.each(chart.series[0].data, function(i, point) {
        var sprite, arrow, x, y;
        
        if (meteogram.resolution &gt; 36e5 || i % 2 === 0) {
            
            // Draw the wind arrows
            x = point.plotX + chart.plotLeft + 7;
            y = 255;
            if (meteogram.windSpeedNames[i] === 'Calm') {
                arrow = chart.renderer.circle(x, y, 10).attr({
                    fill: 'none'
                });
            } else {
                arrow = chart.renderer.path(
                    meteogram.windArrow(meteogram.windSpeedNames[i])
                ).attr({
                    rotation: parseInt(meteogram.windDirections[i], 10),
                    translateX: x, // rotation center
                    translateY: y // rotation center
                });
            }
            arrow.attr({
                stroke: (Highcharts.theme &amp;&amp; Highcharts.theme.contrastTextColor) || 'black',
                'stroke-width': 1.5,
                zIndex: 5
            })
            .add();

        }
    });
};

/** 
 * Draw blocks around wind arrows, below the plot area
 */
Meteogram.prototype.drawBlocksForWindArrows = function (chart) {
    var xAxis = chart.xAxis[0],
        x,
        pos,
        max,
        isLong,
        isLast,
        i;

    for (pos = xAxis.min, max = xAxis.max, i = 0; pos &lt;= max + 36e5; pos += 36e5, i ++) {
        
        // Get the X position
        isLast = pos === max + 36e5;
        x = Math.round(xAxis.toPixels(pos)) + (isLast ? 0.5 : -0.5);
        
        // Draw the vertical dividers and ticks
        if (this.resolution &gt; 36e5) {
            isLong = pos % this.resolution === 0;
        } else {
            isLong = i % 2 === 0;
        }
        chart.renderer.path(['M', x, chart.plotTop + chart.plotHeight + (isLong ? 0 : 28),
            'L', x, chart.plotTop + chart.plotHeight + 32, 'Z'])
            .attr({
                'stroke': chart.options.chart.plotBorderColor,
                'stroke-width': 1
            })
            .add();
    }
};

/**
 * Get the title based on the XML data
 */
Meteogram.prototype.getTitle = function () {
    return 'Meteogram for '+ this.xml.location.name +', '+ this.xml.location.country;
};

/**
 * Build and return the Highcharts options structure
 */
Meteogram.prototype.getChartOptions = function () {
    var meteogram = this;

    return {
        chart: {
            renderTo: this.container,
            marginBottom: 70,
            marginRight: 40,
            marginTop: 50,
            plotBorderWidth: 1,
            width: 800,
            height: 310
        },
        
        title: {
            text: this.getTitle(),
            align: 'left'
        },
        
        credits: {
            text: 'Forecast from &lt;a href="http://yr.no"&gt;yr.no&lt;/a&gt;',
            href: this.xml.credit.link['@attributes'].url,
            position: {
                x: -40
            }
        },
        
        tooltip: {
            shared: true,
            useHTML: true,
            formatter: function () { 
                return meteogram.tooltipFormatter(this); 
            }
        },
        
        xAxis: [{ // Bottom X axis
            type: 'datetime',
            tickInterval: 2 * 36e5, // two hours
            minorTickInterval: 36e5, // one hour
            tickLength: 0,
            gridLineWidth: 1,
            gridLineColor: (Highcharts.theme &amp;&amp; Highcharts.theme.background2) || '#F0F0F0',
            startOnTick: false,
            endOnTick: false,
            minPadding: 0,
            maxPadding: 0,
            offset: 30,
            showLastLabel: true,
            labels: {
                format: '{value:%H}'
            }
        }, { // Top X axis
            linkedTo: 0,
            type: 'datetime',
            tickInterval: 24 * 3600 * 1000,
            labels: {
                format: '{value:&lt;span style="font-size: 12px; font-weight: bold"&gt;%a&lt;/span&gt; %b %e}',
                align: 'left',
                x: 3,
                y: -5
            },
            opposite: true,
            tickLength: 20,
            gridLineWidth: 1
        }],
        
        yAxis: [{ // temperature axis
            title: {
                text: null
            },
            labels: {
                format: '{value}&deg;',
                style: {
                    fontSize: '10px'
                },
                x: -3
            },
            plotLines: [{ // zero plane
                value: 0,
                color: '#BBBBBB',
                width: 1,
                zIndex: 2
            }],
            // Custom positioner to provide even temperature ticks from top down
            tickPositioner: function () {
                var max = Math.ceil(this.max) + 1,
                    pos = max - 12, // start
                    ret;

                if (pos &lt; this.min) {
                    ret = [];
                    while (pos &lt;= max) {
                        ret.push(pos++);
                    }
                } // else return undefined and go auto

                return ret;

            },
            maxPadding: 0.3,
            tickInterval: 1,
            gridLineColor: (Highcharts.theme &amp;&amp; Highcharts.theme.background2) || '#F0F0F0'
            
        }, { // precipitation axis
            title: {
                text: null
            },
            labels: {
                enabled: false
            },
            gridLineWidth: 0,
            tickLength: 0
        
        }, { // Air pressure
            allowDecimals: false,
            title: { // Title on top of axis
                text: 'hPa',
                offset: 0,
                align: 'high',
                rotation: 0,
                style: {
                    fontSize: '10px',
                    color: Highcharts.getOptions().colors[2]                         
                },
                textAlign: 'left',
                x: 3
            },
            labels: {
                style: {
                    fontSize: '8px',
                    color: Highcharts.getOptions().colors[2] 
                },
                y: 2,
                x: 3
            },
            gridLineWidth: 0,
            opposite: true,
            showLastLabel: false
        }],
        
        legend: {
            enabled: false
        },

        plotOptions: {
            series: {
                pointPlacement: 'between'
            }
        },
        
        
        series: [{
            name: 'Temperature',
            data: this.temperatures,
            type: 'spline',
            marker: {
                enabled: false,
                states: {
                    hover: {
                        enabled: true
                    }
                }
            },
            tooltip: {
                valueSuffix: '&deg;C'
            },
            zIndex: 1,
            color: '#FF3333',
            negativeColor: '#48AFE8'
        }, {
            name: 'Precipitation',
            data: this.precipitations,
            type: 'column',
            color: '#68CFE8',
            yAxis: 1,
            groupPadding: 0,
            pointPadding: 0,
            borderWidth: 0,
            shadow: false,
            dataLabels: {
                enabled: true,
                formatter: function () {
                    if (this.y &gt; 0) {
                        return this.y;
                    }
                },
                style: {
                    fontSize: '8px'
                }
            },
            tooltip: {
                valueSuffix: 'mm'
            }
        }, {
            name: 'Air pressure',
            color: Highcharts.getOptions().colors[2],
            data: this.pressures,
            marker: {
                enabled: false
            },
            shadow: false,
            tooltip: {
                valueSuffix: ' hPa'
            },
            dashStyle: 'shortdot',
            yAxis: 2
        }]
    }
};

/** 
 * Post-process the chart from the callback function, the second argument to Highcharts.Chart.
 */
Meteogram.prototype.onChartLoad = function (chart) {

    this.drawWeatherSymbols(chart);
    this.drawWindArrows(chart);
    this.drawBlocksForWindArrows(chart);

};

/**
 * Create the chart. This function is called async when the data file is loaded and parsed.
 */
Meteogram.prototype.createChart = function () {
    var meteogram = this;
    this.chart = new Highcharts.Chart(this.getChartOptions(), function (chart) {
        meteogram.onChartLoad(chart);
    });
};

/**
 * Handle the data. This part of the code is not Highcharts specific, but deals with yr.no's
 * specific data format
 */
Meteogram.prototype.parseYrData = function () {

    var meteogram = this,
        xml = this.xml,
        pointStart;

    if (!xml || !xml.forecast) {
        $('#loading').html('&lt;i class="fa fa-frown-o"&gt;&lt;/i&gt; Failed loading data, please try again later');
        return;
    }

    // The returned xml variable is a JavaScript representation of the provided XML, 
    // generated on the server by running PHP simple_load_xml and converting it to 
    // JavaScript by json_encode.
    $.each(xml.forecast.tabular.time, function(i, time) {
        // Get the times - only Safari can't parse ISO8601 so we need to do some replacements 
        var from = time['@attributes'].from +' UTC',
            to = time['@attributes'].to +' UTC';

        from = from.replace(/-/g, '/').replace('T', ' ');
        from = Date.parse(from);
        to = to.replace(/-/g, '/').replace('T', ' ');
        to = Date.parse(to);
        
        if (to &gt; pointStart + 4 * 24 * 36e5) {
            return;
        }
        
        // If it is more than an hour between points, show all symbols
        if (i === 0) {
            meteogram.resolution = to - from;
        }

        // Populate the parallel arrays
        meteogram.symbols.push(time.symbol['@attributes']['var'].match(/[0-9]{2}[dnm]?/)[0]);
        meteogram.symbolNames.push(time.symbol['@attributes'].name);

        meteogram.temperatures.push({
            x: from,
            y: parseInt(time.temperature['@attributes'].value),
            // custom options used in the tooltip formatter
            to: to,
            index: i
        });

        meteogram.precipitations.push({
            x: from,
            y: parseFloat(time.precipitation['@attributes'].value)
        });
        meteogram.windDirections.push(parseFloat(time.windDirection['@attributes'].deg));
        meteogram.windDirectionNames.push(time.windDirection['@attributes'].name);
        meteogram.windSpeeds.push(parseFloat(time.windSpeed['@attributes'].mps));
        meteogram.windSpeedNames.push(time.windSpeed['@attributes'].name);

        meteogram.pressures.push({
            x: from,
            y: parseFloat(time.pressure['@attributes'].value)
        });
        
        if (i == 0) {
            pointStart = (from + to) / 2;
        }    
    });

    // Smooth the line
    this.smoothLine(this.temperatures);
    
    // Create the chart when the data is loaded
    this.createChart();
};
// End of the Meteogram protype



$(function() { // On DOM ready...
    
    // Set the hash to the yr.no URL we want to parse
    if (!location.hash) {
        var place = 'United_Kingdom/England/London';
        //place = 'France/Rh&ocirc;ne-Alpes/Val_d\'Is&egrave;re~2971074';
        //place = 'Norway/Sogn_og_Fjordane/Vik/M&aring;lset';
        //place = 'United_States/California/San_Francisco';
        //place = 'United_States/Minnesota/Minneapolis';
        location.hash = 'http://www.yr.no/place/' + place + '/forecast_hour_by_hour.xml';

    }

    // Then get the XML file through Highcharts' jsonp provider, see 
    // https://github.com/highslide-software/highcharts.com/blob/master/samples/data/jsonp.php
    // for source code.
    $.getJSON(
        'http://www.highcharts.com/samples/data/jsonp.php?url=' + location.hash.substr(1) + '&amp;callback=?', 
        function (xml) {
            var meteogram = new Meteogram(xml, 'container');
        }
    );

});</pre>
				</div>			
								<a class="button" href="../../js/themes/sand-signika.js"	onclick="return hs.htmlExpand(this, { width: 800, headingText: 'Highcharts Theme: Sand-signika', wrapperClassName: 'draggable-header' })">
					View visual theme &raquo;
				</a>
				<div class="highslide-maincontent">
					<pre>/**
 * Sand-Signika theme for Highcharts JS
 * @author Torstein Honsi
 */

// Load the fonts
Highcharts.createElement('link', {
   href: 'http://fonts.googleapis.com/css?family=Signika:400,700',
   rel: 'stylesheet',
   type: 'text/css'
}, null, document.getElementsByTagName('head')[0]);

// Add the background image to the container
Highcharts.wrap(Highcharts.Chart.prototype, 'getContainer', function (proceed) {
   proceed.call(this);
   this.container.style.background = 'url(http://www.highcharts.com/samples/graphics/sand.png)';
});


Highcharts.theme = {
   colors: ["#f45b5b", "#8085e9", "#8d4654", "#7798BF", "#aaeeee", "#ff0066", "#eeaaee",
      "#55BF3B", "#DF5353", "#7798BF", "#aaeeee"],
   chart: {
      backgroundColor: null,
      style: {
         fontFamily: "Signika, serif"
      }
   },
   title: {
      style: {
         color: 'black',
         fontSize: '16px',
         fontWeight: 'bold'
      }
   },
   subtitle: {
      style: {
         color: 'black'
      }
   },
   tooltip: {
      borderWidth: 0
   },
   legend: {
      itemStyle: {
         fontWeight: 'bold',
         fontSize: '13px'
      }
   },
   xAxis: {
      labels: {
         style: {
            color: '#6e6e70'
         }
      }
   },
   yAxis: {
      labels: {
         style: {
            color: '#6e6e70'
         }
      }
   },
   plotOptions: {
      series: {
         shadow: true
      },
      candlestick: {
         lineColor: '#404048'
      },
      map: {
         shadow: false
      }
   },

   // Highstock specific
   navigator: {
      xAxis: {
         gridLineColor: '#D0D0D8'
      }
   },
   rangeSelector: {
      buttonTheme: {
         fill: 'white',
         stroke: '#C0C0C8',
         'stroke-width': 1,
         states: {
            select: {
               fill: '#D0D0D8'
            }
         }
      }
   },
   scrollbar: {
      trackBorderColor: '#C0C0C8'
   },

   // General
   background2: '#E0E0E8'
   
};

// Apply the theme
Highcharts.setOptions(Highcharts.theme);</pre>
				</div>
								<a class="button" href="http://jsfiddle.net/gh/get/jquery/1.9.1/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/combo-meteogram/">Edit in jsFiddle &raquo;</a>
			</div>
			<div class="clearfix"></div>
		</div>		
	</div>
	<div class="clearfix"></div>
</div>

<script src="/components/com_demo/assets/js/scripts.js"></script>
<script src="/media/com_demo/highslide-full.min.js"></script>
<script src="/media/com_demo/highslide.config.js"></script>
<script src="http://code.highcharts.com/themes/sand-signika.js"></script>

<link type="text/css" rel="stylesheet" href="/components/com_demo/assets/css/highslide.css" />



									</div>
								</div>
																							</div>
							
														<div class="clearfix"></div>
						</div>
					</div>
				</div>
			</div>
			<!--#main-->
			            <!-- ZT Userwrap6 -->
			            <!-- #ZT Userwrap6 -->
            <!-- ZT Userwrap7 -->
			            <!-- #ZT Userwrap7 -->
			<!--Footer-->
			<div id="zt-footer" class="clearfix ">
				<div class="container">
					<div id="zt-footer-inner" class="row-fluid">
						<div id="zt-footer-left" class="span6">
															
							<div id="zt-footer-copy">
							© 2014 Highcharts. All rights reserved.							</div>
						</div>
												<div id="zt-social" class="span4">
							<div>
<a href="https://www.facebook.com/Highcharts" title="Facebook" class="social-icon"><i class="fa fa-facebook"></i></a>
<a href="https://twitter.com/Highcharts" title="Twitter" class="social-icon"><i class="fa fa-twitter"></i></a>
<a href="http://www.linkedin.com/company/highsoft-solutions-as" title="LinkedIn" class="social-icon"><i class="fa fa-linkedin"></i></a>
<a href="https://github.com/highslide-software/highcharts.com" title="Github" class="social-icon"><i class="fa fa-github"></i></a>
</div>
						</div>
												<div class="clearfix"></div>
					</div>
				</div>
			</div>
            <!--#Footer-->
		</div>
	</div>
	
	    <!-- Echo Footer Script -->
        	<script type="text/javascript">
		var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
		document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
	</script>
	<script type="text/javascript">
		try {
			var pageTracker = _gat._getTracker("UA-2995052-3");
			pageTracker._trackPageview();
		} catch(err) {}
	</script>
</body>
</html>